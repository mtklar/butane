(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    138690,       3146]
NotebookOptionsPosition[    135120,       3099]
NotebookOutlinePosition[    135516,       3115]
CellTagsIndexPosition[    135473,       3112]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Initial", " ", "conditions"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"\[Alpha]", "=", "83.7"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Beta]", "=", "43.1"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"u", "=", 
     RowBox[{"1.66054", "*", 
      RowBox[{"10", "^", 
       RowBox[{"-", "27"}]}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"m1", "=", "1"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"m2", "=", "1"}], ";"}], " ", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Phi]0", "=", 
     RowBox[{"109.5", "*", 
      RowBox[{"\[Pi]", "/", "180"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"r0", "=", "1.53"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"G", "=", 
     RowBox[{"DiagonalMatrix", "[", 
      RowBox[{"{", 
       RowBox[{
       "m1", ",", "m1", ",", "m1", ",", "m2", ",", "m2", ",", "m2", ",", "m2",
         ",", "m2", ",", "m2", ",", "m1", ",", "m1", ",", "m1"}], "}"}], 
      "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"EE", "=", "3.577"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"scaling", " ", "=", " ", "1"}], ";"}], 
   RowBox[{"(*", 
    RowBox[{"20.454823", " ", "THz"}], "*)"}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.8016465206783104`*^9, 3.801646523853365*^9}, {
   3.8016465582390113`*^9, 3.801646563958927*^9}, {3.8016469143711205`*^9, 
   3.801646954456658*^9}, 3.8016472264518695`*^9, {3.801647259945587*^9, 
   3.801647265265368*^9}, {3.8017982089059353`*^9, 3.8017982101280336`*^9}, {
   3.8018335206118264`*^9, 3.8018335254509726`*^9}, {3.8019219373062253`*^9, 
   3.801921974215996*^9}, {3.80192213856394*^9, 3.8019221395016656`*^9}, {
   3.801922260111064*^9, 3.8019222662279997`*^9}, {3.8051049327264557`*^9, 
   3.8051049329759545`*^9}, {3.8051049798464932`*^9, 
   3.8051049887255917`*^9}, {3.8051922417692885`*^9, 
   3.8051922456339087`*^9}, {3.805200465816674*^9, 3.805200469271783*^9}, {
   3.8052011431951895`*^9, 3.8052011461688747`*^9}, {3.8052047393900633`*^9, 
   3.80520475592697*^9}, {3.8052900049017982`*^9, 3.805290008346753*^9}, {
   3.8052963479265394`*^9, 3.8052963480859175`*^9}, {3.8053065190105233`*^9, 
   3.805306525799952*^9}, {3.8053839594582057`*^9, 3.8053839638219852`*^9}, {
   3.805445867058668*^9, 3.8054458719014006`*^9}, {3.805478879196747*^9, 
   3.805478880423907*^9}, {3.8055573822638392`*^9, 3.8055573926425033`*^9}, {
   3.8056444511776643`*^9, 3.8056444548951883`*^9}, {3.8056910304129105`*^9, 
   3.805691033060382*^9}, {3.8056948624076595`*^9, 3.8056948663755054`*^9}, {
   3.805695392466471*^9, 3.805695394633918*^9}, {3.8056954277423472`*^9, 
   3.805695432617484*^9}, {3.8056954632875724`*^9, 3.8056954758359823`*^9}, {
   3.8056955678936133`*^9, 3.8056957234964848`*^9}, {3.805695839539997*^9, 
   3.8056958694924927`*^9}, {3.805698145191433*^9, 3.805698182144082*^9}, {
   3.805711564066213*^9, 3.805711565704691*^9}, {3.805711810079766*^9, 
   3.8057118113443356`*^9}, {3.805711897512208*^9, 3.8057118984266744`*^9}, {
   3.8057225973983736`*^9, 3.805722599936987*^9}, {3.8068315154659824`*^9, 
   3.8068315163696012`*^9}, {3.8068316656245227`*^9, 3.8068316663293824`*^9}, 
   3.8068355219433255`*^9, {3.8068357048068695`*^9, 3.8068357055407887`*^9}, {
   3.806861326740774*^9, 3.8068613508611164`*^9}, {3.806864757140746*^9, 
   3.8068647625700445`*^9}, {3.8071666560693502`*^9, 
   3.8071666580517435`*^9}, {3.8071668286334405`*^9, 3.807166830898085*^9}, {
   3.807781495276905*^9, 3.807781500472728*^9}, {3.8082353532916145`*^9, 
   3.8082353558926754`*^9}, {3.8082354312448907`*^9, 3.8082354474835835`*^9}, 
   3.9044043979462757`*^9},
 CellLabel->"In[1]:=",ExpressionUUID->"51004c14-f735-4926-bb05-59b7327f100a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Find", " ", "initial", " ", "position", " ", "in", " ", "N"}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"q1", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "a"}], ",", "0", ",", "b"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"q2", "=", 
     RowBox[{"{", 
      RowBox[{"c", ",", "0", ",", "d"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"q3", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "c"}], ",", "0", ",", 
       RowBox[{"-", "d"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"q4", "=", 
     RowBox[{"{", 
      RowBox[{"a", ",", "0", ",", 
       RowBox[{"-", "b"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"TorsionAngle", " ", "=", " ", 
    RowBox[{"Simplify", "[", 
     RowBox[{
      RowBox[{"VectorAngle", "[", 
       RowBox[{
        RowBox[{"Cross", "[", 
         RowBox[{
          RowBox[{"q2", "-", "q1"}], ",", 
          RowBox[{"q3", "-", "q2"}]}], "]"}], ",", 
        RowBox[{"Cross", "[", 
         RowBox[{
          RowBox[{"q3", "-", "q2"}], ",", 
          RowBox[{"q4", "-", "q3"}]}], "]"}]}], "]"}], ",", 
      RowBox[{"Element", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "}"}], ",", "Reals"}], 
       "]"}]}], "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.8016465206783104`*^9, 3.801646523853365*^9}, {
   3.8016465582390113`*^9, 3.801646563958927*^9}, {3.8016469143711205`*^9, 
   3.801646954456658*^9}, 3.8016472264518695`*^9, {3.801647259945587*^9, 
   3.801647265265368*^9}, {3.8017982089059353`*^9, 3.8017982101280336`*^9}, {
   3.8018335206118264`*^9, 3.8018335254509726`*^9}, {3.8019219373062253`*^9, 
   3.801921974215996*^9}, {3.80192213856394*^9, 3.8019221395016656`*^9}, {
   3.801922260111064*^9, 3.8019222662279997`*^9}, {3.8051049327264557`*^9, 
   3.8051049329759545`*^9}, {3.8051049798464932`*^9, 
   3.8051049887255917`*^9}, {3.8051922417692885`*^9, 
   3.8051922456339087`*^9}, {3.805200465816674*^9, 3.805200469271783*^9}, {
   3.8052011431951895`*^9, 3.8052011461688747`*^9}, {3.8052047393900633`*^9, 
   3.80520475592697*^9}, {3.8052900049017982`*^9, 3.805290008346753*^9}, {
   3.8052963479265394`*^9, 3.8052963480859175`*^9}, {3.8053065190105233`*^9, 
   3.805306525799952*^9}, {3.8053839594582057`*^9, 3.8053839638219852`*^9}, {
   3.805445867058668*^9, 3.8054458719014006`*^9}, {3.805478879196747*^9, 
   3.805478880423907*^9}, {3.8055573822638392`*^9, 3.8055573926425033`*^9}, {
   3.8056444511776643`*^9, 3.8056444548951883`*^9}, {3.8056910304129105`*^9, 
   3.805691033060382*^9}, {3.8056948624076595`*^9, 3.8056948663755054`*^9}, {
   3.805695392466471*^9, 3.805695394633918*^9}, {3.8056954277423472`*^9, 
   3.805695432617484*^9}, {3.8056954632875724`*^9, 3.8056954758359823`*^9}, {
   3.8056955678936133`*^9, 3.8056957234964848`*^9}, {3.805695839539997*^9, 
   3.8056958694924927`*^9}, {3.805698145191433*^9, 3.8056981719164104`*^9}, {
   3.8056982216296773`*^9, 3.805698224056718*^9}, {3.8057013887647057`*^9, 
   3.805701405669243*^9}, 3.8057070134545345`*^9, {3.8057075280393004`*^9, 
   3.8057075285693884`*^9}, 3.8057115707312636`*^9, 3.8068307809378433`*^9, {
   3.8068315603434105`*^9, 3.806831569120841*^9}},
 CellLabel->"In[11]:=",ExpressionUUID->"ba5c78f6-549a-4c2b-94b2-e0096d9c9098"],

Cell[BoxData[
 RowBox[{"CentreM", " ", "=", " ", 
  RowBox[{
   RowBox[{"m1", " ", "q1"}], "+", 
   RowBox[{"m2", " ", "q2"}], "+", 
   RowBox[{"m2", " ", "q3"}], "+", 
   RowBox[{"m1", " ", "q4"}]}]}]], "Input",
 CellChangeTimes->{{3.8016465206783104`*^9, 3.801646523853365*^9}, {
   3.8016465582390113`*^9, 3.801646563958927*^9}, {3.8016469143711205`*^9, 
   3.801646954456658*^9}, 3.8016472264518695`*^9, {3.801647259945587*^9, 
   3.801647265265368*^9}, {3.8017982089059353`*^9, 3.8017982101280336`*^9}, {
   3.8018335206118264`*^9, 3.8018335254509726`*^9}, {3.8019219373062253`*^9, 
   3.801921974215996*^9}, {3.80192213856394*^9, 3.8019221395016656`*^9}, {
   3.801922260111064*^9, 3.8019222662279997`*^9}, {3.8051049327264557`*^9, 
   3.8051049329759545`*^9}, {3.8051049798464932`*^9, 
   3.8051049887255917`*^9}, {3.8051922417692885`*^9, 
   3.8051922456339087`*^9}, {3.805200465816674*^9, 3.805200469271783*^9}, {
   3.8052011431951895`*^9, 3.8052011461688747`*^9}, {3.8052047393900633`*^9, 
   3.80520475592697*^9}, {3.8052900049017982`*^9, 3.805290008346753*^9}, {
   3.8052963479265394`*^9, 3.8052963480859175`*^9}, {3.8053065190105233`*^9, 
   3.805306525799952*^9}, {3.8053839594582057`*^9, 3.8053839638219852`*^9}, {
   3.805445867058668*^9, 3.8054458719014006`*^9}, {3.805478879196747*^9, 
   3.805478880423907*^9}, {3.8055573822638392`*^9, 3.8055573926425033`*^9}, {
   3.8056444511776643`*^9, 3.8056444548951883`*^9}, {3.8056910304129105`*^9, 
   3.805691033060382*^9}, {3.8056948624076595`*^9, 3.8056948663755054`*^9}, {
   3.805695392466471*^9, 3.805695394633918*^9}, {3.8056954277423472`*^9, 
   3.805695432617484*^9}, {3.8056954632875724`*^9, 3.8056954758359823`*^9}, {
   3.8056955678936133`*^9, 3.8056957234964848`*^9}, {3.805695839539997*^9, 
   3.8056958694924927`*^9}, {3.805698145191433*^9, 3.8056981719164104`*^9}, {
   3.8056982216296773`*^9, 3.805698224056718*^9}, {3.8057013887647057`*^9, 
   3.805701405669243*^9}, 3.8057070134545345`*^9, {3.8057075280393004`*^9, 
   3.8057075285693884`*^9}, 3.8057115707312636`*^9, 3.8068307809378433`*^9, {
   3.8068315603434105`*^9, 3.8068315660034513`*^9}},
 CellLabel->"In[16]:=",ExpressionUUID->"2c4e49c0-b907-45fc-aea6-23b66535ea9c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"BLength1", " ", "=", 
   RowBox[{"Sqrt", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"q2", "-", "q1"}], ")"}], ".", 
     RowBox[{"(", 
      RowBox[{"q2", "-", "q1"}], ")"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BLength2", " ", "=", 
   RowBox[{"Sqrt", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"q3", "-", "q2"}], ")"}], ".", 
     RowBox[{"(", 
      RowBox[{"q3", "-", "q2"}], ")"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BLength3", " ", "=", 
   RowBox[{"Sqrt", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"q4", "-", "q3"}], ")"}], ".", 
     RowBox[{"(", 
      RowBox[{"q4", "-", "q3"}], ")"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BAngle1", "=", 
   RowBox[{"VectorAngle", "[", 
    RowBox[{
     RowBox[{"q1", "-", "q2"}], ",", 
     RowBox[{"q3", "-", "q2"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BAngle2", "=", 
   RowBox[{"VectorAngle", "[", 
    RowBox[{
     RowBox[{"q2", "-", "q3"}], ",", 
     RowBox[{"q4", "-", "q3"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sol", "=", 
   RowBox[{
    RowBox[{"Solve", "[", 
     RowBox[{
      RowBox[{"{", " ", 
       RowBox[{
        RowBox[{"BLength1", "\[Equal]", "r0"}], ",", 
        RowBox[{"BLength2", "\[Equal]", "r0"}], ",", 
        RowBox[{"BLength3", "\[Equal]", "r0"}], ",", 
        RowBox[{
         RowBox[{"ArcCos", "[", 
          FractionBox[
           RowBox[{
            RowBox[{"4", " ", "a", " ", "c"}], "-", 
            RowBox[{"4", " ", "b", " ", "d"}], "+", 
            SuperscriptBox["r0", "2"]}], 
           RowBox[{"2", " ", 
            SuperscriptBox["r0", "2"]}]], "]"}], "\[Equal]", "\[Phi]0"}], " ",
         ",", " ", 
        RowBox[{"c", "\[Equal]", "d"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "}"}]}], "]"}], "//", 
    "Last"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"q0", " ", "=", " ", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "a"}], ",", "0", ",", "b", ",", " ", "c", ",", "0", ",", 
      "d", ",", 
      RowBox[{"-", "c"}], ",", "0", ",", 
      RowBox[{"-", "d"}], ",", " ", "a", ",", "0", ",", 
      RowBox[{"-", "b"}]}], "}"}], "/.", "sol"}]}], " ", ";"}]}], "Input",
 CellChangeTimes->{{3.8016465206783104`*^9, 3.801646523853365*^9}, {
   3.8016465582390113`*^9, 3.801646563958927*^9}, {3.8016469143711205`*^9, 
   3.801646954456658*^9}, 3.8016472264518695`*^9, {3.801647259945587*^9, 
   3.801647265265368*^9}, {3.8017982089059353`*^9, 3.8017982101280336`*^9}, {
   3.8018335206118264`*^9, 3.8018335254509726`*^9}, {3.8019219373062253`*^9, 
   3.801921974215996*^9}, {3.80192213856394*^9, 3.8019221395016656`*^9}, {
   3.801922260111064*^9, 3.8019222662279997`*^9}, {3.8051049327264557`*^9, 
   3.8051049329759545`*^9}, {3.8051049798464932`*^9, 
   3.8051049887255917`*^9}, {3.8051922417692885`*^9, 
   3.8051922456339087`*^9}, {3.805200465816674*^9, 3.805200469271783*^9}, {
   3.8052011431951895`*^9, 3.8052011461688747`*^9}, {3.8052047393900633`*^9, 
   3.80520475592697*^9}, {3.8052900049017982`*^9, 3.805290008346753*^9}, {
   3.8052963479265394`*^9, 3.8052963480859175`*^9}, {3.8053065190105233`*^9, 
   3.805306525799952*^9}, {3.8053839594582057`*^9, 3.8053839638219852`*^9}, {
   3.805445867058668*^9, 3.8054458719014006`*^9}, {3.805478879196747*^9, 
   3.805478880423907*^9}, {3.8055573822638392`*^9, 3.8055573926425033`*^9}, {
   3.8056444511776643`*^9, 3.8056444548951883`*^9}, {3.8056910304129105`*^9, 
   3.805691033060382*^9}, {3.8056948624076595`*^9, 3.8056948663755054`*^9}, {
   3.805695392466471*^9, 3.805695394633918*^9}, {3.8056954277423472`*^9, 
   3.805695432617484*^9}, {3.8056954632875724`*^9, 3.8056954758359823`*^9}, {
   3.8056955678936133`*^9, 3.8056957234964848`*^9}, {3.805695839539997*^9, 
   3.8056958694924927`*^9}, {3.805698145191433*^9, 3.8056981719164104`*^9}, {
   3.8056982216296773`*^9, 3.805698224056718*^9}, {3.8057013887647057`*^9, 
   3.805701405669243*^9}, 3.8057070134545345`*^9, {3.8057075280393004`*^9, 
   3.8057075285693884`*^9}, 3.8057115707312636`*^9, 3.8068307809378433`*^9, {
   3.8068315603434105`*^9, 3.806831564623268*^9}, {3.806842621007518*^9, 
   3.8068426327157464`*^9}, {3.8068426964293656`*^9, 
   3.8068427001263685`*^9}, {3.806842814880698*^9, 3.8068428194452553`*^9}, {
   3.8068428584976635`*^9, 3.806842862205874*^9}, {3.8068429289580746`*^9, 
   3.8068429331748075`*^9}, 3.806843054163684*^9, 3.8068431616183033`*^9, {
   3.8068433174453387`*^9, 3.806843344272008*^9}},
 CellLabel->"In[17]:=",ExpressionUUID->"0a03b019-faf3-48b0-af6c-1ca2cf1bbbb9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"{", 
   RowBox[{"BLength1", ",", " ", "BLength2", ",", "BLength3"}], "}"}], "/.", 
  "sol"}]], "Input",
 CellChangeTimes->{{3.8016465206783104`*^9, 3.801646523853365*^9}, {
   3.8016465582390113`*^9, 3.801646563958927*^9}, {3.8016469143711205`*^9, 
   3.801646954456658*^9}, 3.8016472264518695`*^9, {3.801647259945587*^9, 
   3.801647265265368*^9}, {3.8017982089059353`*^9, 3.8017982101280336`*^9}, {
   3.8018335206118264`*^9, 3.8018335254509726`*^9}, {3.8019219373062253`*^9, 
   3.801921974215996*^9}, {3.80192213856394*^9, 3.8019221395016656`*^9}, {
   3.801922260111064*^9, 3.8019222662279997`*^9}, {3.8051049327264557`*^9, 
   3.8051049329759545`*^9}, {3.8051049798464932`*^9, 
   3.8051049887255917`*^9}, {3.8051922417692885`*^9, 
   3.8051922456339087`*^9}, {3.805200465816674*^9, 3.805200469271783*^9}, {
   3.8052011431951895`*^9, 3.8052011461688747`*^9}, {3.8052047393900633`*^9, 
   3.80520475592697*^9}, {3.8052900049017982`*^9, 3.805290008346753*^9}, {
   3.8052963479265394`*^9, 3.8052963480859175`*^9}, {3.8053065190105233`*^9, 
   3.805306525799952*^9}, {3.8053839594582057`*^9, 3.8053839638219852`*^9}, {
   3.805445867058668*^9, 3.8054458719014006`*^9}, {3.805478879196747*^9, 
   3.805478880423907*^9}, {3.8055573822638392`*^9, 3.8055573926425033`*^9}, {
   3.8056444511776643`*^9, 3.8056444548951883`*^9}, {3.8056910304129105`*^9, 
   3.805691033060382*^9}, {3.8056948624076595`*^9, 3.8056948663755054`*^9}, {
   3.805695392466471*^9, 3.805695394633918*^9}, {3.8056954277423472`*^9, 
   3.805695432617484*^9}, {3.8056954632875724`*^9, 3.8056954758359823`*^9}, {
   3.8056955678936133`*^9, 3.8056957234964848`*^9}, {3.805695839539997*^9, 
   3.8056958694924927`*^9}, {3.805698145191433*^9, 3.8056981719164104`*^9}, {
   3.8056982216296773`*^9, 3.805698224056718*^9}, {3.8057013887647057`*^9, 
   3.805701405669243*^9}, 3.8057070134545345`*^9, {3.8057075280393004`*^9, 
   3.8057075285693884`*^9}, 3.8057115707312636`*^9, 3.8068307809378433`*^9, {
   3.8068315603434105`*^9, 3.806831564623268*^9}, {3.806842621007518*^9, 
   3.8068426327157464`*^9}, {3.8068426964293656`*^9, 
   3.8068427001263685`*^9}, {3.806842814880698*^9, 3.8068428194452553`*^9}, {
   3.8068428584976635`*^9, 3.806842862205874*^9}, {3.8068429289580746`*^9, 
   3.8068429331748075`*^9}, {3.806843054163684*^9, 3.8068430648171954`*^9}},
 CellLabel->"In[24]:=",ExpressionUUID->"d869491e-a87f-4745-b2d3-6a98953c6a24"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"BAngle1", ",", " ", "BAngle2"}], "}"}], 
   RowBox[{"180", "/", "\[Pi]"}]}], "/.", "sol"}]], "Input",
 CellChangeTimes->{{3.8016465206783104`*^9, 3.801646523853365*^9}, {
   3.8016465582390113`*^9, 3.801646563958927*^9}, {3.8016469143711205`*^9, 
   3.801646954456658*^9}, 3.8016472264518695`*^9, {3.801647259945587*^9, 
   3.801647265265368*^9}, {3.8017982089059353`*^9, 3.8017982101280336`*^9}, {
   3.8018335206118264`*^9, 3.8018335254509726`*^9}, {3.8019219373062253`*^9, 
   3.801921974215996*^9}, {3.80192213856394*^9, 3.8019221395016656`*^9}, {
   3.801922260111064*^9, 3.8019222662279997`*^9}, {3.8051049327264557`*^9, 
   3.8051049329759545`*^9}, {3.8051049798464932`*^9, 
   3.8051049887255917`*^9}, {3.8051922417692885`*^9, 
   3.8051922456339087`*^9}, {3.805200465816674*^9, 3.805200469271783*^9}, {
   3.8052011431951895`*^9, 3.8052011461688747`*^9}, {3.8052047393900633`*^9, 
   3.80520475592697*^9}, {3.8052900049017982`*^9, 3.805290008346753*^9}, {
   3.8052963479265394`*^9, 3.8052963480859175`*^9}, {3.8053065190105233`*^9, 
   3.805306525799952*^9}, {3.8053839594582057`*^9, 3.8053839638219852`*^9}, {
   3.805445867058668*^9, 3.8054458719014006`*^9}, {3.805478879196747*^9, 
   3.805478880423907*^9}, {3.8055573822638392`*^9, 3.8055573926425033`*^9}, {
   3.8056444511776643`*^9, 3.8056444548951883`*^9}, {3.8056910304129105`*^9, 
   3.805691033060382*^9}, {3.8056948624076595`*^9, 3.8056948663755054`*^9}, {
   3.805695392466471*^9, 3.805695394633918*^9}, {3.8056954277423472`*^9, 
   3.805695432617484*^9}, {3.8056954632875724`*^9, 3.8056954758359823`*^9}, {
   3.8056955678936133`*^9, 3.8056957234964848`*^9}, {3.805695839539997*^9, 
   3.8056958694924927`*^9}, {3.805698145191433*^9, 3.8056981719164104`*^9}, {
   3.8056982216296773`*^9, 3.805698224056718*^9}, {3.8057013887647057`*^9, 
   3.805701405669243*^9}, 3.8057070134545345`*^9, {3.8057075280393004`*^9, 
   3.8057075285693884`*^9}, 3.8057115707312636`*^9, 3.8068307809378433`*^9, {
   3.8068315603434105`*^9, 3.806831564623268*^9}, {3.806842621007518*^9, 
   3.8068426327157464`*^9}, {3.8068426964293656`*^9, 
   3.8068427001263685`*^9}, {3.806842814880698*^9, 3.8068428194452553`*^9}, {
   3.8068428584976635`*^9, 3.806842862205874*^9}, {3.8068429289580746`*^9, 
   3.8068429331748075`*^9}, {3.806843054163684*^9, 3.8068430671258388`*^9}, {
   3.806862940646781*^9, 3.806862960071396*^9}},
 CellLabel->"In[25]:=",ExpressionUUID->"9cd61fd8-55f1-4717-bb49-553672127a93"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Calculate", " ", "static", " ", "Hessian", " ", "for", " ", "initial", 
    " ", "condition"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"x1", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{"x11", ",", " ", "x12", ",", " ", "x13"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"x2", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{"x21", ",", " ", "x22", ",", " ", "x23"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"x3", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{"x31", ",", " ", "x32", ",", " ", "x33"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"x4", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{"x41", ",", " ", "x42", ",", " ", "x43"}], "}"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"\[Psi]1", " ", "=", " ", 
     RowBox[{
      RowBox[{"Sqrt", "[", "\[Alpha]", "]"}], 
      RowBox[{"Sqrt", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"x1", "-", "x2"}], ")"}], ".", 
        RowBox[{"(", 
         RowBox[{"x1", "-", "x2"}], ")"}]}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Psi]2", "=", "  ", 
     RowBox[{
      RowBox[{"Sqrt", "[", "\[Alpha]", "]"}], 
      RowBox[{"Sqrt", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"x2", "-", "x3"}], ")"}], ".", 
        RowBox[{"(", 
         RowBox[{"x2", "-", "x3"}], ")"}]}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Psi]3", " ", "=", " ", 
     RowBox[{
      RowBox[{"Sqrt", "[", "\[Alpha]", "]"}], 
      RowBox[{"Sqrt", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"x3", "-", "x4"}], ")"}], ".", 
        RowBox[{"(", 
         RowBox[{"x3", "-", "x4"}], ")"}]}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Psi]4", " ", "=", " ", 
     FractionBox[
      RowBox[{
       RowBox[{"Sqrt", "[", "\[Beta]", "]"}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"x1", "-", "x2"}], ")"}], ".", 
        RowBox[{"(", 
         RowBox[{"x3", "-", "x2"}], ")"}]}]}], 
      RowBox[{" ", 
       RowBox[{
        RowBox[{"Sqrt", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"x1", "-", "x2"}], ")"}], ".", 
          RowBox[{"(", 
           RowBox[{"x1", "-", "x2"}], ")"}]}], "]"}], 
        RowBox[{"Sqrt", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"x3", "-", "x2"}], ")"}], ".", 
          RowBox[{"(", 
           RowBox[{"x3", "-", "x2"}], ")"}]}], "]"}]}]}]]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Psi]5", " ", "=", " ", 
     FractionBox[
      RowBox[{
       RowBox[{"Sqrt", "[", "\[Beta]", "]"}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"x2", "-", "x3"}], ")"}], ".", 
        RowBox[{"(", 
         RowBox[{"x4", "-", "x3"}], ")"}]}]}], 
      RowBox[{" ", 
       RowBox[{
        RowBox[{"Sqrt", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"x2", "-", "x3"}], ")"}], ".", 
          RowBox[{"(", 
           RowBox[{"x2", "-", "x3"}], ")"}]}], "]"}], 
        RowBox[{"Sqrt", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"x4", "-", "x3"}], ")"}], ".", 
          RowBox[{"(", 
           RowBox[{"x4", "-", "x3"}], ")"}]}], "]"}]}]}]]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"D\[Psi]1", "=", 
     RowBox[{"D", "[", 
      RowBox[{"\[Psi]1", ",", 
       RowBox[{"{", 
        RowBox[{"Join", "[", 
         RowBox[{"x1", ",", " ", "x2", ",", " ", "x3", ",", " ", "x4"}], 
         "]"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"D\[Psi]2", "=", 
     RowBox[{"D", "[", 
      RowBox[{"\[Psi]2", ",", 
       RowBox[{"{", 
        RowBox[{"Join", "[", 
         RowBox[{"x1", ",", " ", "x2", ",", " ", "x3", ",", " ", "x4"}], 
         "]"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"D\[Psi]3", "=", 
     RowBox[{"D", "[", 
      RowBox[{"\[Psi]3", ",", 
       RowBox[{"{", 
        RowBox[{"Join", "[", 
         RowBox[{"x1", ",", " ", "x2", ",", " ", "x3", ",", " ", "x4"}], 
         "]"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"D\[Psi]4", "=", 
     RowBox[{"D", "[", 
      RowBox[{"\[Psi]4", ",", 
       RowBox[{"{", 
        RowBox[{"Join", "[", 
         RowBox[{"x1", ",", " ", "x2", ",", " ", "x3", ",", " ", "x4"}], 
         "]"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"D\[Psi]5", "=", 
     RowBox[{"D", "[", 
      RowBox[{"\[Psi]5", ",", 
       RowBox[{"{", 
        RowBox[{"Join", "[", 
         RowBox[{"x1", ",", " ", "x2", ",", " ", "x3", ",", " ", "x4"}], 
         "]"}], "}"}]}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"H", " ", "=", "  ", 
     RowBox[{
      RowBox[{"Inverse", "[", "G", "]"}], ".", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"TensorProduct", "[", 
         RowBox[{"D\[Psi]1", ",", "D\[Psi]1"}], "]"}], " ", "+", " ", 
        RowBox[{"TensorProduct", "[", 
         RowBox[{"D\[Psi]2", ",", "D\[Psi]2"}], "]"}], "+", 
        RowBox[{"TensorProduct", "[", 
         RowBox[{"D\[Psi]3", ",", "D\[Psi]3"}], "]"}], "+", 
        RowBox[{"TensorProduct", "[", 
         RowBox[{"D\[Psi]4", ",", "D\[Psi]4"}], "]"}], "+", 
        RowBox[{"TensorProduct", "[", 
         RowBox[{"D\[Psi]5", ",", "D\[Psi]5"}], "]"}]}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"H", " ", "=", " ", 
     RowBox[{"H", "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"x11", "\[Rule]", 
         RowBox[{"q0", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ",", 
        RowBox[{"x12", "\[Rule]", 
         RowBox[{"q0", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ",", 
        RowBox[{"x13", "\[Rule]", 
         RowBox[{"q0", "[", 
          RowBox[{"[", "3", "]"}], "]"}]}], ",", 
        RowBox[{"x21", "\[Rule]", 
         RowBox[{"q0", "[", 
          RowBox[{"[", "4", "]"}], "]"}]}], ",", 
        RowBox[{"x22", "\[Rule]", 
         RowBox[{"q0", "[", 
          RowBox[{"[", "5", "]"}], "]"}]}], ",", 
        RowBox[{"x23", "\[Rule]", 
         RowBox[{"q0", "[", 
          RowBox[{"[", "6", "]"}], "]"}]}], ",", 
        RowBox[{"x31", "\[Rule]", 
         RowBox[{"q0", "[", 
          RowBox[{"[", "7", "]"}], "]"}]}], ",", 
        RowBox[{"x32", "\[Rule]", 
         RowBox[{"q0", "[", 
          RowBox[{"[", "8", "]"}], "]"}]}], ",", 
        RowBox[{"x33", "\[Rule]", 
         RowBox[{"q0", "[", 
          RowBox[{"[", "9", "]"}], "]"}]}], ",", 
        RowBox[{"x41", "\[Rule]", 
         RowBox[{"q0", "[", 
          RowBox[{"[", "10", "]"}], "]"}]}], ",", 
        RowBox[{"x42", "\[Rule]", 
         RowBox[{"q0", "[", 
          RowBox[{"[", "11", "]"}], "]"}]}], ",", 
        RowBox[{"x43", "\[Rule]", 
         RowBox[{"q0", "[", 
          RowBox[{"[", "12", "]"}], "]"}]}]}], "}"}]}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.801646535943349*^9, 3.801646537099303*^9}, {
   3.8016465732361145`*^9, 3.8016465760162907`*^9}, 3.8016466190032425`*^9, {
   3.8016466982618294`*^9, 3.8016466994695873`*^9}, {3.8016491724029307`*^9, 
   3.801649321081461*^9}, {3.8016494217524104`*^9, 3.8016494578325453`*^9}, {
   3.8016498362790194`*^9, 3.801649838998082*^9}, {3.8016601927316637`*^9, 
   3.8016602009929347`*^9}, {3.801660282951091*^9, 3.8016602862773666`*^9}, {
   3.801660427380402*^9, 3.801660431483123*^9}, {3.801660526092628*^9, 
   3.8016605286882286`*^9}, {3.8016605610308623`*^9, 
   3.8016605697607756`*^9}, {3.8051049798621187`*^9, 
   3.8051049798621187`*^9}, {3.8052047396189384`*^9, 3.805204752186117*^9}, {
   3.805364871226863*^9, 3.8053648933439198`*^9}, {3.805695427757971*^9, 
   3.805695427773594*^9}, {3.805695725086071*^9, 3.8056957436793017`*^9}, {
   3.805695925374235*^9, 3.805696041369463*^9}, {3.8056963822505035`*^9, 
   3.805696409886815*^9}, {3.8056978409476147`*^9, 3.805697842509452*^9}},
 CellLabel->"In[26]:=",ExpressionUUID->"aea67561-4661-4c1d-b100-f1a94fb3102a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Calculate", " ", "spectral", " ", "decomposition"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"valsH", ",", " ", "vecsH"}], "}"}], "=", " ", 
     RowBox[{"Eigensystem", "[", "H", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Proj1", "=", 
     RowBox[{"TensorProduct", "[", 
      RowBox[{
       RowBox[{"vecsH", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
       RowBox[{"vecsH", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Proj2", "=", 
     RowBox[{"TensorProduct", "[", 
      RowBox[{
       RowBox[{"vecsH", "[", 
        RowBox[{"[", "2", "]"}], "]"}], ",", " ", 
       RowBox[{"vecsH", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Proj3", "=", 
     RowBox[{"TensorProduct", "[", 
      RowBox[{
       RowBox[{"vecsH", "[", 
        RowBox[{"[", "3", "]"}], "]"}], ",", " ", 
       RowBox[{"vecsH", "[", 
        RowBox[{"[", "3", "]"}], "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Proj4", "=", 
     RowBox[{"TensorProduct", "[", 
      RowBox[{
       RowBox[{"vecsH", "[", 
        RowBox[{"[", "4", "]"}], "]"}], ",", " ", 
       RowBox[{"vecsH", "[", 
        RowBox[{"[", "4", "]"}], "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Proj5", "=", 
     RowBox[{"TensorProduct", "[", 
      RowBox[{
       RowBox[{"vecsH", "[", 
        RowBox[{"[", "5", "]"}], "]"}], ",", " ", 
       RowBox[{"vecsH", "[", 
        RowBox[{"[", "5", "]"}], "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Proj6", "=", 
     RowBox[{"TensorProduct", "[", 
      RowBox[{
       RowBox[{"vecsH", "[", 
        RowBox[{"[", "6", "]"}], "]"}], ",", " ", 
       RowBox[{"vecsH", "[", 
        RowBox[{"[", "6", "]"}], "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Proj7", "=", 
     RowBox[{"TensorProduct", "[", 
      RowBox[{
       RowBox[{"vecsH", "[", 
        RowBox[{"[", "7", "]"}], "]"}], ",", " ", 
       RowBox[{"vecsH", "[", 
        RowBox[{"[", "7", "]"}], "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Proj8", "=", 
     RowBox[{"TensorProduct", "[", 
      RowBox[{
       RowBox[{"vecsH", "[", 
        RowBox[{"[", "8", "]"}], "]"}], ",", " ", 
       RowBox[{"vecsH", "[", 
        RowBox[{"[", "8", "]"}], "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Proj9", "=", 
     RowBox[{"TensorProduct", "[", 
      RowBox[{
       RowBox[{"vecsH", "[", 
        RowBox[{"[", "9", "]"}], "]"}], ",", " ", 
       RowBox[{"vecsH", "[", 
        RowBox[{"[", "9", "]"}], "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Proj10", "=", 
     RowBox[{"TensorProduct", "[", 
      RowBox[{
       RowBox[{"vecsH", "[", 
        RowBox[{"[", "10", "]"}], "]"}], ",", " ", 
       RowBox[{"vecsH", "[", 
        RowBox[{"[", "10", "]"}], "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Proj11", "=", 
     RowBox[{"TensorProduct", "[", 
      RowBox[{
       RowBox[{"vecsH", "[", 
        RowBox[{"[", "11", "]"}], "]"}], ",", " ", 
       RowBox[{"vecsH", "[", 
        RowBox[{"[", "11", "]"}], "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Proj12", "=", 
     RowBox[{"TensorProduct", "[", 
      RowBox[{
       RowBox[{"vecsH", "[", 
        RowBox[{"[", "12", "]"}], "]"}], ",", " ", 
       RowBox[{"vecsH", "[", 
        RowBox[{"[", "12", "]"}], "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"HSpec", " ", "=", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"valsH", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "Proj1"}], "+", 
      RowBox[{
       RowBox[{"valsH", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "Proj2"}], "+", 
      RowBox[{
       RowBox[{"valsH", "[", 
        RowBox[{"[", "3", "]"}], "]"}], "Proj3"}], "+", 
      RowBox[{
       RowBox[{"valsH", "[", 
        RowBox[{"[", "4", "]"}], "]"}], "Proj4"}], "+", 
      RowBox[{
       RowBox[{"valsH", "[", 
        RowBox[{"[", "5", "]"}], "]"}], "Proj5"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"P", "=", 
     RowBox[{
     "Proj1", "+", "Proj2", "+", "Proj3", "+", "Proj4", "+", "Proj5"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Q", "=", 
     RowBox[{
     "Proj6", "+", "Proj7", "+", "Proj8", "+", "Proj9", "+", "Proj10", "+", 
      "Proj11", "+", "Proj12"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.8016624679407954`*^9, 3.8016625084151917`*^9}, 
   3.8019219125073223`*^9, {3.805384114215341*^9, 3.8053841289401026`*^9}, {
   3.8053841674107523`*^9, 3.805384180695052*^9}, 3.805391523278202*^9, {
   3.805391873254139*^9, 3.8053918844803696`*^9}, {3.8053920531187043`*^9, 
   3.8053920533130007`*^9}, 3.805392087344205*^9, {3.805429695221549*^9, 
   3.8054297348491526`*^9}, {3.8054297691009836`*^9, 
   3.8054297865050583`*^9}, {3.805430071568214*^9, 3.805430077657898*^9}, {
   3.805480359126188*^9, 3.8054803895951614`*^9}, {3.8056967616243343`*^9, 
   3.805696804114774*^9}, {3.805697771035413*^9, 3.8056978019458413`*^9}, {
   3.8056978451469235`*^9, 3.8056978477268934`*^9}, {3.8056978921585264`*^9, 
   3.80569789868421*^9}, {3.806824240114727*^9, 3.806824458081419*^9}, {
   3.8068549290686445`*^9, 3.806854980875617*^9}},
 CellLabel->"In[42]:=",ExpressionUUID->"4a0e5709-a5b2-4adf-957b-a817991c7201"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Calculate", " ", "static", " ", "reduced", " ", "Hessian", " ", "for", 
    " ", "initial", " ", "condition"}], "*)"}], "\n", 
  RowBox[{
   RowBox[{
    RowBox[{"HRed", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"D\[Psi]1", ".", 
          RowBox[{"Inverse", "[", "G", "]"}], ".", "D\[Psi]1"}], ",", 
         RowBox[{"D\[Psi]1", ".", 
          RowBox[{"Inverse", "[", "G", "]"}], ".", "D\[Psi]2"}], ",", 
         RowBox[{"D\[Psi]1", ".", 
          RowBox[{"Inverse", "[", "G", "]"}], ".", "D\[Psi]3"}], ",", 
         RowBox[{"D\[Psi]1", ".", 
          RowBox[{"Inverse", "[", "G", "]"}], ".", "D\[Psi]4"}], ",", 
         RowBox[{"D\[Psi]1", ".", 
          RowBox[{"Inverse", "[", "G", "]"}], ".", "D\[Psi]5"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"D\[Psi]2", ".", 
          RowBox[{"Inverse", "[", "G", "]"}], ".", "D\[Psi]1"}], ",", 
         RowBox[{"D\[Psi]2", ".", 
          RowBox[{"Inverse", "[", "G", "]"}], ".", "D\[Psi]2"}], ",", 
         RowBox[{"D\[Psi]2", ".", 
          RowBox[{"Inverse", "[", "G", "]"}], ".", "D\[Psi]3"}], ",", 
         RowBox[{"D\[Psi]2", ".", 
          RowBox[{"Inverse", "[", "G", "]"}], ".", "D\[Psi]4"}], ",", 
         RowBox[{"D\[Psi]2", ".", 
          RowBox[{"Inverse", "[", "G", "]"}], ".", "D\[Psi]5"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"D\[Psi]3", ".", 
          RowBox[{"Inverse", "[", "G", "]"}], ".", "D\[Psi]1"}], ",", 
         RowBox[{"D\[Psi]3", ".", 
          RowBox[{"Inverse", "[", "G", "]"}], ".", "D\[Psi]2"}], ",", 
         RowBox[{"D\[Psi]3", ".", 
          RowBox[{"Inverse", "[", "G", "]"}], ".", "D\[Psi]3"}], ",", 
         RowBox[{"D\[Psi]3", ".", 
          RowBox[{"Inverse", "[", "G", "]"}], ".", "D\[Psi]4"}], ",", 
         RowBox[{"D\[Psi]3", ".", 
          RowBox[{"Inverse", "[", "G", "]"}], ".", "D\[Psi]5"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"D\[Psi]4", ".", 
          RowBox[{"Inverse", "[", "G", "]"}], ".", "D\[Psi]1"}], ",", 
         RowBox[{"D\[Psi]4", ".", 
          RowBox[{"Inverse", "[", "G", "]"}], ".", "D\[Psi]2"}], ",", 
         RowBox[{"D\[Psi]4", ".", 
          RowBox[{"Inverse", "[", "G", "]"}], ".", "D\[Psi]3"}], ",", 
         RowBox[{"D\[Psi]4", ".", 
          RowBox[{"Inverse", "[", "G", "]"}], ".", "D\[Psi]4"}], ",", 
         RowBox[{"D\[Psi]4", ".", 
          RowBox[{"Inverse", "[", "G", "]"}], ".", "D\[Psi]5"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"D\[Psi]5", ".", 
          RowBox[{"Inverse", "[", "G", "]"}], ".", "D\[Psi]1"}], ",", 
         RowBox[{"D\[Psi]5", ".", 
          RowBox[{"Inverse", "[", "G", "]"}], ".", "D\[Psi]2"}], ",", 
         RowBox[{"D\[Psi]5", ".", 
          RowBox[{"Inverse", "[", "G", "]"}], ".", "D\[Psi]3"}], ",", 
         RowBox[{"D\[Psi]5", ".", 
          RowBox[{"Inverse", "[", "G", "]"}], ".", "D\[Psi]4"}], ",", 
         RowBox[{"D\[Psi]5", ".", 
          RowBox[{"Inverse", "[", "G", "]"}], ".", "D\[Psi]5"}]}], "}"}]}], 
      "}"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"HRed", " ", "=", " ", 
     RowBox[{"HRed", "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"x11", "\[Rule]", 
         RowBox[{"q0", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ",", 
        RowBox[{"x12", "\[Rule]", 
         RowBox[{"q0", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ",", 
        RowBox[{"x13", "\[Rule]", 
         RowBox[{"q0", "[", 
          RowBox[{"[", "3", "]"}], "]"}]}], ",", 
        RowBox[{"x21", "\[Rule]", 
         RowBox[{"q0", "[", 
          RowBox[{"[", "4", "]"}], "]"}]}], ",", 
        RowBox[{"x22", "\[Rule]", 
         RowBox[{"q0", "[", 
          RowBox[{"[", "5", "]"}], "]"}]}], ",", 
        RowBox[{"x23", "\[Rule]", 
         RowBox[{"q0", "[", 
          RowBox[{"[", "6", "]"}], "]"}]}], ",", 
        RowBox[{"x31", "\[Rule]", 
         RowBox[{"q0", "[", 
          RowBox[{"[", "7", "]"}], "]"}]}], ",", 
        RowBox[{"x32", "\[Rule]", 
         RowBox[{"q0", "[", 
          RowBox[{"[", "8", "]"}], "]"}]}], ",", 
        RowBox[{"x33", "\[Rule]", 
         RowBox[{"q0", "[", 
          RowBox[{"[", "9", "]"}], "]"}]}], ",", 
        RowBox[{"x41", "\[Rule]", 
         RowBox[{"q0", "[", 
          RowBox[{"[", "10", "]"}], "]"}]}], ",", 
        RowBox[{"x42", "\[Rule]", 
         RowBox[{"q0", "[", 
          RowBox[{"[", "11", "]"}], "]"}]}], ",", 
        RowBox[{"x43", "\[Rule]", 
         RowBox[{"q0", "[", 
          RowBox[{"[", "12", "]"}], "]"}]}]}], "}"}]}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.8016503802625294`*^9, 3.801650420831911*^9}, {
   3.8016510131218653`*^9, 3.8016510394168997`*^9}, 3.801651177337145*^9, 
   3.801651238318096*^9, {3.8016518008324523`*^9, 3.801651844395928*^9}, 
   3.80166025904806*^9, {3.8051049262564707`*^9, 3.805104926990672*^9}, {
   3.805364824711484*^9, 3.805364859073625*^9}, {3.805695427773594*^9, 
   3.805695427828692*^9}, {3.8056964474039392`*^9, 3.805696466674839*^9}, {
   3.8056966721744776`*^9, 3.805696683075817*^9}, {3.8056967370538163`*^9, 
   3.805696739612772*^9}, 3.8056967760960016`*^9, {3.805697926675311*^9, 
   3.8056979279888573`*^9}, {3.8068315957723436`*^9, 3.806831597956854*^9}},
 CellLabel->"In[58]:=",ExpressionUUID->"2d00c411-dc66-444f-808b-68d685681a19"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Calculate", " ", "eigenvalues"}], " ", "-", " ", 
    RowBox[{"My", " ", "calculations"}]}], "*)"}], "\n", 
  RowBox[{
   RowBox[{
    RowBox[{"\[Eta]1", " ", "=", " ", 
     RowBox[{
      FractionBox["\[Alpha]", "m1"], "+", 
      FractionBox["\[Alpha]", "m2"]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Eta]2", " ", "=", " ", 
     FractionBox[
      RowBox[{"\[Alpha]", " ", 
       RowBox[{"Cos", "[", "\[Phi]0", "]"}]}], "m2"]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Eta]3", " ", "=", " ", 
     FractionBox[
      RowBox[{"2", "\[Alpha]"}], "m2"]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Eta]4", " ", "=", " ", 
     RowBox[{
      FractionBox[
       RowBox[{"Sqrt", "[", 
        RowBox[{"\[Alpha]", " ", "\[Beta]"}], "]"}], 
       RowBox[{"r0", " ", "m2"}]], 
      RowBox[{
       RowBox[{"Sin", "[", "\[Phi]0", "]"}], "^", "2"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Eta]5", " ", "=", " ", 
     RowBox[{
      RowBox[{"-", 
       FractionBox[
        RowBox[{"Sqrt", "[", 
         RowBox[{"\[Alpha]", " ", "\[Beta]"}], "]"}], 
        RowBox[{"r0", " ", "m2"}]]}], 
      RowBox[{
       RowBox[{"Sin", "[", "\[Phi]0", "]"}], "^", "2"}], "x"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Eta]6", " ", "=", " ", 
     RowBox[{
      FractionBox[
       RowBox[{"2", "\[Beta]"}], 
       RowBox[{
        RowBox[{"r0", "^", "2"}], " ", "m2"}]], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Cos", "[", "\[Phi]0", "]"}], "-", "1"}], ")"}], 
      RowBox[{
       RowBox[{"Sin", "[", "\[Phi]0", "]"}], "^", "2"}], "x"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Eta]7", " ", "=", " ", 
     RowBox[{
      RowBox[{
       FractionBox["\[Beta]", 
        RowBox[{"r0", "^", "2"}]], 
       RowBox[{"(", 
        RowBox[{
         FractionBox["1", "m1"], "+", 
         FractionBox["1", "m2"]}], ")"}], 
       RowBox[{
        RowBox[{"Sin", "[", "\[Phi]0", "]"}], "^", "2"}]}], "-", 
      RowBox[{
       FractionBox[
        RowBox[{"2", "\[Beta]"}], 
        RowBox[{
         RowBox[{"r0", "^", "2"}], "m2"}]], 
       RowBox[{
        RowBox[{"Sin", "[", "\[Phi]0", "]"}], "^", "2"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Cos", "[", "\[Phi]0", "]"}], "-", "1"}], ")"}]}]}]}], ";"}],
    "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"HR", " ", "=", " ", 
     RowBox[{"(", GridBox[{
        {"\[Eta]1", "\[Eta]2", "0", "\[Eta]4", "\[Eta]5"},
        {"\[Eta]2", "\[Eta]3", "\[Eta]2", "\[Eta]4", "\[Eta]4"},
        {"0", "\[Eta]2", "\[Eta]1", "\[Eta]5", "\[Eta]4"},
        {"\[Eta]4", "\[Eta]4", "\[Eta]5", "\[Eta]7", "\[Eta]6"},
        {"\[Eta]5", "\[Eta]4", "\[Eta]4", "\[Eta]6", "\[Eta]7"}
       }], ")"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"valsHR", " ", "=", " ", 
     RowBox[{"Eigenvalues", "[", "HR", "]"}]}], ";"}], "\n", 
   RowBox[{"Plot", "[", 
    RowBox[{
     RowBox[{"scaling", "*", 
      RowBox[{"Sqrt", "[", 
       RowBox[{"valsHR", "/.", 
        RowBox[{"x", "\[Rule]", " ", 
         RowBox[{"Cos", "[", "\[Theta]", "]"}]}]}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"\[Theta]", ",", " ", "0", ",", 
       RowBox[{"2", "\[Pi]"}]}], "}"}]}], "]"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Inter", "=", 
     RowBox[{"x", "/.", 
      RowBox[{"Last", "[", 
       RowBox[{"NMinimize", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Abs", "[", 
            RowBox[{
             RowBox[{"valsHR", "[", 
              RowBox[{"[", "3", "]"}], "]"}], "-", 
             RowBox[{"valsHR", "[", 
              RowBox[{"[", "4", "]"}], "]"}]}], "]"}], ",", 
           RowBox[{
            RowBox[{"-", "1"}], "\[LessEqual]", "x"}], ",", " ", 
           RowBox[{"x", "\[LessEqual]", "1"}]}], "}"}], ",", "x"}], "]"}], 
       "]"}]}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"w2HR", " ", "=", " ", 
     RowBox[{"FunctionInterpolation", "[", 
      RowBox[{
       RowBox[{"Piecewise", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"scaling", " ", 
             RowBox[{"Sqrt", "[", 
              RowBox[{"valsHR", "[", 
               RowBox[{"[", "4", "]"}], "]"}], "]"}]}], ",", 
            RowBox[{"x", "<", "Inter"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"scaling", " ", 
             RowBox[{"Sqrt", "[", 
              RowBox[{"valsHR", "[", 
               RowBox[{"[", "3", "]"}], "]"}], "]"}]}], ",", 
            RowBox[{"x", ">=", "Inter"}]}], "}"}]}], "}"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", 
         RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.8016469794665723`*^9, 3.801646988691672*^9}, {
   3.801647019169351*^9, 3.801647022738639*^9}, 3.801647757786208*^9, 
   3.801647868371832*^9, {3.805375634280513*^9, 3.8053756738911543`*^9}, {
   3.8053793214510965`*^9, 3.8053793241833105`*^9}, {3.8053799125827594`*^9, 
   3.80537993880618*^9}, 3.8053801123120327`*^9, {3.8054282455775237`*^9, 
   3.8054282651887302`*^9}, {3.805697300238367*^9, 3.8056973013793707`*^9}, {
   3.8056974744834642`*^9, 3.8056974930951405`*^9}, {3.8056976545344524`*^9, 
   3.8056977375373816`*^9}, {3.805697802124264*^9, 3.805697802261151*^9}, {
   3.8056979600470076`*^9, 3.8056979606080437`*^9}, 3.8068362045421267`*^9, {
   3.806842520366067*^9, 3.806842537662821*^9}, 3.8068645523971186`*^9, {
   3.8082352827669373`*^9, 3.808235282886608*^9}},
 CellLabel->"In[60]:=",ExpressionUUID->"4073beca-0768-45da-92ad-386bf331ba59"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Calc", " ", "eigenvalues", " ", "Bornemnn", " ", "calculations"}],
    "*)"}], "\n", 
  RowBox[{
   RowBox[{
    RowBox[{"\[Eta]21", " ", "=", " ", 
     RowBox[{
      FractionBox["\[Alpha]", "m1"], "+", 
      FractionBox["\[Alpha]", "m2"]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Eta]22", " ", "=", " ", 
     FractionBox[
      RowBox[{"\[Alpha]", " ", 
       RowBox[{"Cos", "[", "\[Phi]0", "]"}]}], "m2"]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Eta]23", " ", "=", " ", 
     FractionBox[
      RowBox[{"2", "\[Alpha]"}], "m2"]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Eta]24", " ", "=", " ", 
     RowBox[{
      RowBox[{"-", 
       FractionBox[
        RowBox[{"Sqrt", "[", 
         RowBox[{"\[Alpha]", " ", "\[Beta]"}], "]"}], 
        RowBox[{"r0", " ", "m2"}]]}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{"Cos", "[", "\[Phi]0", "]"}]}], ")"}], "^", "2"}]}]}], ";"}],
    "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Eta]25", " ", "=", " ", 
     RowBox[{
      RowBox[{"-", 
       FractionBox[
        RowBox[{"Sqrt", "[", 
         RowBox[{"\[Alpha]", " ", "\[Beta]"}], "]"}], 
        RowBox[{"r0", " ", "m2"}]]}], 
      RowBox[{
       RowBox[{"Sin", "[", "\[Phi]0", "]"}], "^", "2"}], "x"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Eta]26", " ", "=", " ", 
     RowBox[{
      FractionBox[
       RowBox[{"2", "\[Beta]"}], 
       RowBox[{
        RowBox[{"r0", "^", "2"}], " ", "m2"}]], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Cos", "[", "\[Phi]0", "]"}], "+", "1"}], ")"}], 
      RowBox[{
       RowBox[{"Sin", "[", "\[Phi]0", "]"}], "^", "2"}], "x"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Eta]27", " ", "=", " ", 
     RowBox[{
      FractionBox[
       RowBox[{"\[Beta]", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"Cos", "[", "\[Phi]0", "]"}]}], ")"}]}], 
       RowBox[{"r0", "^", "2"}]], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           FractionBox["1", "m1"], "+", 
           FractionBox["1", "m2"]}], ")"}], 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"Cos", "[", "\[Phi]0", "]"}]}], ")"}]}], "+", 
        RowBox[{
         FractionBox["2", "m2"], 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"Cos", "[", "\[Phi]0", "]"}]}], ")"}], "^", "2"}]}]}], 
       ")"}]}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"HR2", " ", "=", " ", 
     RowBox[{"(", GridBox[{
        {"\[Eta]21", "\[Eta]22", "0", "\[Eta]24", "\[Eta]25"},
        {"\[Eta]22", "\[Eta]23", "\[Eta]22", "\[Eta]24", "\[Eta]24"},
        {"0", "\[Eta]22", "\[Eta]21", "\[Eta]25", "\[Eta]24"},
        {"\[Eta]24", "\[Eta]24", "\[Eta]25", "\[Eta]27", "\[Eta]26"},
        {"\[Eta]25", "\[Eta]24", "\[Eta]24", "\[Eta]26", "\[Eta]27"}
       }], ")"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"valsHR2", " ", "=", " ", 
     RowBox[{"Eigenvalues", "[", "HR2", "]"}]}], ";"}], "\n", 
   RowBox[{"Plot", "[", 
    RowBox[{
     RowBox[{"scaling", "*", 
      RowBox[{"Sqrt", "[", 
       RowBox[{"valsHR2", "/.", 
        RowBox[{"x", "\[Rule]", 
         RowBox[{"Cos", "[", "\[Theta]", "]"}]}]}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"\[Theta]", ",", "0", ",", 
       RowBox[{"2", "\[Pi]"}]}], "}"}]}], "]"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"w2HR2", "=", 
     RowBox[{"FunctionInterpolation", "[", 
      RowBox[{
       RowBox[{"scaling", "*", " ", 
        RowBox[{"Sqrt", "[", 
         RowBox[{"valsHR2", "[", 
          RowBox[{"[", "4", "]"}], "]"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", 
         RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.801647065258586*^9, 3.801647094301243*^9}, 
   3.801647764416443*^9, 3.801647910992296*^9, 3.80537346272795*^9, {
   3.805375422518114*^9, 3.8053754706027527`*^9}, 3.8053792656241136`*^9, {
   3.805697615338975*^9, 3.8056977228032913`*^9}, {3.8057332092934637`*^9, 
   3.8057332252863293`*^9}, 3.806864552612118*^9},
 CellLabel->"In[72]:=",ExpressionUUID->"0009769c-c768-432c-a5ef-f73214e7ffab"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Find", " ", "initial", " ", "velocity", " ", "in", " ", "TxN"}], 
   "*)"}], "\n", 
  RowBox[{
   RowBox[{
    RowBox[{"v0", " ", "=", 
     RowBox[{"{", 
      RowBox[{
      "v1", ",", "v2", ",", "v3", ",", "v4", ",", "v5", ",", "v6", ",", "v7", 
       ",", "v8", ",", "v9", ",", "v10", ",", "v11", ",", "v12"}], "}"}]}], 
    ";"}], "\n", 
   RowBox[{"(*", 
    RowBox[{"Zero", " ", "linear", " ", "momentum"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"LinMom", "=", 
     RowBox[{
      RowBox[{"m1", " ", 
       RowBox[{"v0", "[", 
        RowBox[{"[", 
         RowBox[{"1", ";;", "3"}], "]"}], "]"}]}], "+", 
      RowBox[{"m2", " ", 
       RowBox[{"v0", "[", 
        RowBox[{"[", 
         RowBox[{"4", ";;", "6"}], "]"}], "]"}]}], "+", 
      RowBox[{"m2", " ", 
       RowBox[{"v0", "[", 
        RowBox[{"[", 
         RowBox[{"7", ";;", "9"}], "]"}], "]"}]}], "+", 
      RowBox[{"m1", " ", 
       RowBox[{"v0", "[", 
        RowBox[{"[", 
         RowBox[{"10", ";;", "12"}], "]"}], "]"}]}]}]}], ";"}], "\n", 
   RowBox[{"(*", 
    RowBox[{"Zero", " ", "angular", " ", "momentum"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"AngMom", "=", " ", 
     RowBox[{
      RowBox[{"m1", " ", 
       RowBox[{"Cross", "[", 
        RowBox[{
         RowBox[{"q0", "[", 
          RowBox[{"[", 
           RowBox[{"1", ";;", "3"}], "]"}], "]"}], ",", 
         RowBox[{"v0", "[", 
          RowBox[{"[", 
           RowBox[{"1", ";;", "3"}], "]"}], "]"}]}], "]"}]}], "+", 
      RowBox[{"m2", " ", 
       RowBox[{"Cross", "[", 
        RowBox[{
         RowBox[{"q0", "[", 
          RowBox[{"[", 
           RowBox[{"4", ";;", "6"}], "]"}], "]"}], ",", 
         RowBox[{"v0", "[", 
          RowBox[{"[", 
           RowBox[{"4", ";;", "6"}], "]"}], "]"}]}], "]"}]}], "+", 
      RowBox[{"m2", " ", 
       RowBox[{"Cross", "[", 
        RowBox[{
         RowBox[{"q0", "[", 
          RowBox[{"[", 
           RowBox[{"7", ";;", "9"}], "]"}], "]"}], ",", 
         RowBox[{"v0", "[", 
          RowBox[{"[", 
           RowBox[{"7", ";;", "9"}], "]"}], "]"}]}], "]"}]}], "+", 
      RowBox[{"m1", " ", 
       RowBox[{"Cross", "[", 
        RowBox[{
         RowBox[{"q0", "[", 
          RowBox[{"[", 
           RowBox[{"10", ";;", "12"}], "]"}], "]"}], ",", 
         RowBox[{"v0", "[", 
          RowBox[{"[", 
           RowBox[{"10", ";;", "12"}], "]"}], "]"}]}], "]"}]}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"v0Aux", "=", 
     RowBox[{"v0", "/.", 
      RowBox[{"ToRules", "[", 
       RowBox[{"Reduce", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"LinMom", "\[Equal]", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ",", 
           RowBox[{"AngMom", "==", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "0"}], "}"}]}]}], "}"}], ",", "v0", 
         ",", " ", "Reals"}], "]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Linear", " ", "independent", " ", "subspace", " ", "such", " ", "that", 
     " ", "above", " ", "is", " ", "true"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "v0P", " ", "has", " ", "constant", " ", "linear", " ", "and", " ", 
     "angular", " ", "momemntum", " ", "and", " ", "is", " ", "in", " ", "P", 
     " ", "space"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"v0P", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"v0Aux", "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"v1", "\[Rule]", "1"}], ",", 
          RowBox[{"v2", "\[Rule]", "0"}], ",", 
          RowBox[{"v3", "\[Rule]", "0"}], ",", 
          RowBox[{"v4", "\[Rule]", "0"}], ",", 
          RowBox[{"v6", "\[Rule]", "0"}], ",", 
          RowBox[{"v7", "\[Rule]", "0"}]}], " ", "}"}]}], ",", 
       RowBox[{"v0Aux", "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"v1", "\[Rule]", "0"}], ",", 
          RowBox[{"v2", "\[Rule]", "0"}], ",", 
          RowBox[{"v3", "\[Rule]", "1"}], ",", 
          RowBox[{"v4", "\[Rule]", "0"}], ",", 
          RowBox[{"v6", "\[Rule]", "0"}], ",", 
          RowBox[{"v7", "\[Rule]", "0"}]}], " ", "}"}]}], ",", 
       RowBox[{"v0Aux", "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"v1", "\[Rule]", "0"}], ",", 
          RowBox[{"v2", "\[Rule]", "0"}], ",", 
          RowBox[{"v3", "\[Rule]", "0"}], ",", 
          RowBox[{"v4", "\[Rule]", "1"}], ",", 
          RowBox[{"v6", "\[Rule]", "0"}], ",", 
          RowBox[{"v7", "\[Rule]", "0"}]}], " ", "}"}]}], ",", 
       RowBox[{"v0Aux", "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"v1", "\[Rule]", "0"}], ",", 
          RowBox[{"v2", "\[Rule]", "0"}], ",", 
          RowBox[{"v3", "\[Rule]", "0"}], ",", 
          RowBox[{"v4", "\[Rule]", "0"}], ",", 
          RowBox[{"v6", "\[Rule]", "1"}], ",", 
          RowBox[{"v7", "\[Rule]", "0"}]}], " ", "}"}]}], ",", 
       RowBox[{"v0Aux", "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"v1", "\[Rule]", "0"}], ",", 
          RowBox[{"v2", "\[Rule]", "0"}], ",", 
          RowBox[{"v3", "\[Rule]", "0"}], ",", 
          RowBox[{"v4", "\[Rule]", "0"}], ",", 
          RowBox[{"v6", "\[Rule]", "0"}], ",", 
          RowBox[{"v7", "\[Rule]", "1"}]}], "}"}]}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "v0Q", " ", "has", " ", "constant", " ", "linear", " ", "and", " ", 
     "angular", " ", "momemntum", " ", "and", " ", "is", " ", "in", " ", "Q", 
     " ", "space"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"v0Q", "=", 
     RowBox[{"Normalize", "[", 
      RowBox[{"v0Aux", "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"v1", "\[Rule]", "0"}], ",", 
         RowBox[{"v2", "\[Rule]", "1"}], ",", 
         RowBox[{"v3", "\[Rule]", "0"}], ",", 
         RowBox[{"v4", "\[Rule]", "0"}], ",", 
         RowBox[{"v6", "\[Rule]", "0"}], ",", 
         RowBox[{"v7", "\[Rule]", "0"}]}], "}"}]}], "]"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.8016465206783104`*^9, 3.801646523853365*^9}, {
   3.8016465582390113`*^9, 3.801646563958927*^9}, {3.8016469143711205`*^9, 
   3.801646954456658*^9}, 3.8016472264518695`*^9, {3.801647259945587*^9, 
   3.801647265265368*^9}, {3.8017982089059353`*^9, 3.8017982101280336`*^9}, {
   3.8018335206118264`*^9, 3.8018335254509726`*^9}, {3.8019219373062253`*^9, 
   3.801921974215996*^9}, {3.80192213856394*^9, 3.8019221395016656`*^9}, {
   3.801922260111064*^9, 3.8019222662279997`*^9}, {3.8051049327264557`*^9, 
   3.8051049329759545`*^9}, {3.8051049798464932`*^9, 
   3.8051049887255917`*^9}, {3.8051922417692885`*^9, 
   3.8051922456339087`*^9}, {3.805200465816674*^9, 3.805200469271783*^9}, {
   3.8052011431951895`*^9, 3.8052011461688747`*^9}, {3.8052047393900633`*^9, 
   3.80520475592697*^9}, {3.8052900049017982`*^9, 3.805290008346753*^9}, {
   3.8052963479265394`*^9, 3.8052963480859175`*^9}, {3.8053065190105233`*^9, 
   3.805306525799952*^9}, {3.8053839594582057`*^9, 3.8053839638219852`*^9}, {
   3.805445867058668*^9, 3.8054458719014006`*^9}, {3.805478879196747*^9, 
   3.805478880423907*^9}, {3.8055573822638392`*^9, 3.8055573926425033`*^9}, {
   3.8056444511776643`*^9, 3.8056444548951883`*^9}, {3.8056910304129105`*^9, 
   3.805691033060382*^9}, {3.8056948624076595`*^9, 3.8056948663755054`*^9}, {
   3.805695392466471*^9, 3.805695394633918*^9}, {3.8056954277423472`*^9, 
   3.805695432617484*^9}, {3.8056954632875724`*^9, 3.8056954758359823`*^9}, {
   3.8056955678936133`*^9, 3.8056957234964848`*^9}, {3.805695839539997*^9, 
   3.8056958694924927`*^9}, {3.805698145191433*^9, 3.8056981719164104`*^9}, {
   3.8056982216296773`*^9, 3.805698224056718*^9}, {3.8057013887647057`*^9, 
   3.805701436246755*^9}, {3.805707518335371*^9, 3.8057075438773794`*^9}, 
   3.805711025168766*^9, {3.8068299467369866`*^9, 3.806829950477255*^9}, {
   3.8068437211360617`*^9, 3.8068437562786813`*^9}, {3.806844397034751*^9, 
   3.8068444270584545`*^9}, {3.80685408384107*^9, 3.8068540874871845`*^9}, {
   3.8068626569363937`*^9, 3.8068626600672646`*^9}},
 CellLabel->"In[83]:=",ExpressionUUID->"01c6c25d-d491-4869-a683-b2fd98e4455b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Define", " ", "potentials"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"q1", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"q11", "[", "t", "]"}], ",", " ", 
       RowBox[{"q12", "[", "t", "]"}], ",", " ", 
       RowBox[{"q13", "[", "t", "]"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"q2", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"q21", "[", "t", "]"}], ",", " ", 
       RowBox[{"q22", "[", "t", "]"}], ",", " ", 
       RowBox[{"q23", "[", "t", "]"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"q3", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"q31", "[", "t", "]"}], ",", " ", 
       RowBox[{"q32", "[", "t", "]"}], ",", " ", 
       RowBox[{"q33", "[", "t", "]"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"q4", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"q41", "[", "t", "]"}], ",", " ", 
       RowBox[{"q42", "[", "t", "]"}], ",", " ", 
       RowBox[{"q43", "[", "t", "]"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"cos\[Phi]1", "=", 
     FractionBox[
      RowBox[{
       RowBox[{"(", 
        RowBox[{"q1", "-", "q2"}], ")"}], ".", 
       RowBox[{"(", 
        RowBox[{"q3", "-", "q2"}], ")"}]}], 
      RowBox[{
       RowBox[{"Sqrt", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"q1", "-", "q2"}], ")"}], ".", 
         RowBox[{"(", 
          RowBox[{"q1", "-", "q2"}], ")"}]}], "]"}], 
       RowBox[{"Sqrt", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"q3", "-", "q2"}], ")"}], ".", 
         RowBox[{"(", 
          RowBox[{"q3", "-", "q2"}], ")"}]}], "]"}]}]]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"cos\[Phi]2", "=", 
     FractionBox[
      RowBox[{
       RowBox[{"(", 
        RowBox[{"q2", "-", "q3"}], ")"}], ".", 
       RowBox[{"(", 
        RowBox[{"q4", "-", "q3"}], ")"}]}], 
      RowBox[{
       RowBox[{"Sqrt", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"q2", "-", "q3"}], ")"}], ".", 
         RowBox[{"(", 
          RowBox[{"q2", "-", "q3"}], ")"}]}], "]"}], 
       RowBox[{"Sqrt", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"q4", "-", "q3"}], ")"}], ".", 
         RowBox[{"(", 
          RowBox[{"q4", "-", "q3"}], ")"}]}], "]"}]}]]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"cos\[Theta]", "=", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"Cross", "[", 
        RowBox[{
         RowBox[{"q2", "-", "q1"}], ",", 
         RowBox[{"q3", "-", "q2"}]}], "]"}], ".", 
       RowBox[{"Cross", "[", 
        RowBox[{
         RowBox[{"q3", "-", "q2"}], ",", 
         RowBox[{"q4", "-", "q3"}]}], "]"}]}], "/", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Sqrt", "[", 
         RowBox[{
          RowBox[{"Cross", "[", 
           RowBox[{
            RowBox[{"q2", "-", "q1"}], ",", 
            RowBox[{"q3", "-", "q2"}]}], "]"}], ".", 
          RowBox[{"Cross", "[", 
           RowBox[{
            RowBox[{"q2", "-", "q1"}], ",", 
            RowBox[{"q3", "-", "q2"}]}], "]"}]}], "]"}], 
        RowBox[{"Sqrt", "[", 
         RowBox[{
          RowBox[{"Cross", "[", 
           RowBox[{
            RowBox[{"q3", "-", "q2"}], ",", 
            RowBox[{"q4", "-", "q3"}]}], "]"}], ".", 
          RowBox[{"Cross", "[", 
           RowBox[{
            RowBox[{"q3", "-", "q2"}], ",", 
            RowBox[{"q4", "-", "q3"}]}], "]"}]}], "]"}]}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"V1", " ", "=", " ", 
     RowBox[{
      FractionBox["\[Alpha]", "2"], "  ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Sqrt", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"q1", "-", "q2"}], ")"}], ".", 
           RowBox[{"(", 
            RowBox[{"q1", "-", "q2"}], ")"}]}], "]"}], "-", "r0"}], ")"}], 
       "^", "2"}]}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"V2", " ", "=", " ", 
     RowBox[{
      FractionBox["\[Alpha]", "2"], "  ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Sqrt", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"q2", "-", "q3"}], ")"}], ".", 
           RowBox[{"(", 
            RowBox[{"q2", "-", "q3"}], ")"}]}], "]"}], "-", "r0"}], ")"}], 
       "^", "2"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"V3", " ", "=", " ", 
     RowBox[{
      FractionBox["\[Alpha]", "2"], "  ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Sqrt", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"q3", "-", "q4"}], ")"}], ".", 
           RowBox[{"(", 
            RowBox[{"q3", "-", "q4"}], ")"}]}], "]"}], "-", "r0"}], ")"}], 
       "^", "2"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"V4", "=", 
     RowBox[{
      FractionBox["\[Beta]", "2"], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"cos\[Phi]1", "-", 
         RowBox[{"Cos", "[", "\[Phi]0", "]"}]}], ")"}], "^", "2"}]}]}], ";"}],
    "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"V5", "=", 
     RowBox[{
      FractionBox["\[Beta]", "2"], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"cos\[Phi]2", "-", 
         RowBox[{"Cos", "[", "\[Phi]0", "]"}]}], ")"}], "^", "2"}]}]}], ";"}],
    "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Vstrong", " ", "=", " ", 
     RowBox[{"V1", "+", "V2", "+", "V3", "+", "V4", "+", "V5"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Vweak", "=", " ", 
     RowBox[{"1.116", "-", 
      RowBox[{"1.462", " ", "cos\[Theta]"}], "-", 
      RowBox[{"1.578", " ", 
       RowBox[{"cos\[Theta]", "^", "2"}]}], "+", 
      RowBox[{"0.368", " ", 
       RowBox[{"cos\[Theta]", "^", "3"}]}], "+", 
      RowBox[{"3.156", " ", 
       RowBox[{"cos\[Theta]", "^", "4"}]}], "+", 
      RowBox[{"3.788", " ", 
       RowBox[{"cos\[Theta]", "^", "5"}]}]}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.8016466497822566`*^9, 3.801646688995042*^9}, 
   3.8016477272334385`*^9, {3.8016631236106977`*^9, 3.801663124716004*^9}, {
   3.8056972306505475`*^9, 3.8056972725343094`*^9}, {3.805709534052978*^9, 
   3.805709584316229*^9}, {3.8057096357454123`*^9, 3.805709728030758*^9}, {
   3.8057097607251434`*^9, 3.805709775922514*^9}, {3.8057098915331154`*^9, 
   3.805709944557744*^9}, {3.805710010770442*^9, 3.8057100448737917`*^9}, {
   3.8057100770160108`*^9, 3.8057103547785845`*^9}, {3.805710992225087*^9, 
   3.805711069738031*^9}, 3.8057192153004484`*^9, {3.805719587260805*^9, 
   3.8057195885456557`*^9}, {3.8057227947499027`*^9, 3.805722805382287*^9}, {
   3.80686351773862*^9, 3.806863584588544*^9}, {3.8068637729551377`*^9, 
   3.8068637730726557`*^9}, {3.806863866510479*^9, 3.8068638671670465`*^9}, {
   3.8068651284354153`*^9, 3.806865128557876*^9}, {3.8068651950322866`*^9, 
   3.806865195159628*^9}, {3.8068652424019613`*^9, 3.806865242530053*^9}, {
   3.806865386490319*^9, 3.8068653924833555`*^9}},
 CellLabel->"In[89]:=",ExpressionUUID->"89ceac61-97e4-4cd8-8d1b-74c7d8be786e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Set", " ", "initial", " ", "velocity"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"s1", "=", 
   RowBox[{
    FractionBox["1", "2"], 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"Q", ".", "v0Q"}], ")"}], ".", "G", ".", 
     RowBox[{"(", 
      RowBox[{"Q", ".", "v0Q"}], ")"}]}]}]}]}]], "Input",
 CellFrame->{{0, 0}, {0, 0.5}},
 CellChangeTimes->{{3.8054300877671957`*^9, 3.805430103659319*^9}, {
   3.805446089238859*^9, 3.8054460948553953`*^9}, {3.8054462036891036`*^9, 
   3.8054462396609955`*^9}, {3.8054849978394723`*^9, 
   3.8054850023515587`*^9}, {3.8055280684410477`*^9, 
   3.8055280715764627`*^9}, {3.8055404398412557`*^9, 
   3.8055404416350155`*^9}, {3.8055407072210875`*^9, 3.805540711415766*^9}, {
   3.805541384980008*^9, 3.805541385425804*^9}, {3.8055414420489264`*^9, 
   3.8055414421447935`*^9}, {3.8055417349923806`*^9, 
   3.8055417353302755`*^9}, {3.8055419067496076`*^9, 3.805541908060919*^9}, {
   3.805541964957071*^9, 3.8055419653370485`*^9}, {3.805644674432024*^9, 
   3.805644689326928*^9}, {3.8056447243434935`*^9, 3.805644724729763*^9}, {
   3.805648168765316*^9, 3.8056481756351786`*^9}, {3.8056539064228196`*^9, 
   3.8056539295463247`*^9}, {3.8056540668865805`*^9, 3.805654066984803*^9}, {
   3.805654110285739*^9, 3.805654110384491*^9}, {3.8056541556554327`*^9, 
   3.8056541557413416`*^9}, {3.8056542299500237`*^9, 3.8056542317812524`*^9}, 
   3.8056543099228535`*^9, {3.805654358269128*^9, 3.805654368009179*^9}, {
   3.8056544642616158`*^9, 3.805654465551602*^9}, {3.805654507577317*^9, 
   3.8056545108366966`*^9}, {3.805654584657906*^9, 3.8056545847659454`*^9}, 
   3.8056549428986197`*^9, {3.805690945881709*^9, 3.8056909504122095`*^9}, {
   3.805691129877775*^9, 3.805691133002037*^9}, {3.8056948777912235`*^9, 
   3.8056948891102767`*^9}, {3.8056949216317205`*^9, 3.805694927469806*^9}, {
   3.805695575019693*^9, 3.805695576097562*^9}, 3.8056977800217304`*^9, {
   3.8057111000260644`*^9, 3.805711157757343*^9}, {3.8057112680852766`*^9, 
   3.8057113099274597`*^9}, {3.805711641739091*^9, 3.8057116666802793`*^9}, {
   3.8057227237414885`*^9, 3.805722724199424*^9}, {3.8057227816882224`*^9, 
   3.805722782395424*^9}, {3.805722879128221*^9, 3.805722881555817*^9}, 
   3.805723053897018*^9, {3.8057231352221413`*^9, 3.8057231353216267`*^9}, {
   3.8057232185873413`*^9, 3.8057232294479685`*^9}, {3.805731032834529*^9, 
   3.8057310557155223`*^9}, {3.8057312754829855`*^9, 
   3.8057312910725603`*^9}, {3.8057313439970284`*^9, 
   3.8057315533814726`*^9}, {3.805732422724962*^9, 3.8057324827829056`*^9}, {
   3.805732523478693*^9, 3.805732566351097*^9}, {3.805732597747841*^9, 
   3.805732619790183*^9}, {3.8057328907882867`*^9, 3.8057328923865623`*^9}, 
   3.805732956917194*^9, {3.8057331542309875`*^9, 3.805733161061239*^9}, {
   3.8057333186123285`*^9, 3.8057333281107783`*^9}, {3.805733704947318*^9, 
   3.8057337290149565`*^9}, {3.8057340347674465`*^9, 3.805734061517826*^9}, {
   3.806824052626663*^9, 3.8068240788423967`*^9}, {3.8068245106946297`*^9, 
   3.8068245759051332`*^9}, 3.8068246410077033`*^9, {3.8068298246438456`*^9, 
   3.806829825862313*^9}, {3.80682986463428*^9, 3.806829893351037*^9}, {
   3.806829985886611*^9, 3.8068299908013783`*^9}, {3.8068300219848404`*^9, 
   3.8068300322142944`*^9}, {3.8068310804626465`*^9, 
   3.8068310841543207`*^9}, {3.8068311314800377`*^9, 3.8068311499406796`*^9}},
 CellLabel->
  "In[103]:=",ExpressionUUID->"06c97fb3-91b3-4725-b75e-77fb30a82e1a"],

Cell[BoxData[
 RowBox[{"s2", "=", 
  RowBox[{
   FractionBox["1", "2"], 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"Proj2", ".", 
      RowBox[{"vecsH", "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], ")"}], ".", "G", ".", 
    RowBox[{"(", 
     RowBox[{"Proj2", ".", 
      RowBox[{"vecsH", "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], ")"}]}]}]}]], "Input",
 CellChangeTimes->{{3.8054300877671957`*^9, 3.805430103659319*^9}, {
   3.805446089238859*^9, 3.8054460948553953`*^9}, {3.8054462036891036`*^9, 
   3.8054462396609955`*^9}, {3.8054849978394723`*^9, 
   3.8054850023515587`*^9}, {3.8055280684410477`*^9, 
   3.8055280715764627`*^9}, {3.8055404398412557`*^9, 
   3.8055404416350155`*^9}, {3.8055407072210875`*^9, 3.805540711415766*^9}, {
   3.805541384980008*^9, 3.805541385425804*^9}, {3.8055414420489264`*^9, 
   3.8055414421447935`*^9}, {3.8055417349923806`*^9, 
   3.8055417353302755`*^9}, {3.8055419067496076`*^9, 3.805541908060919*^9}, {
   3.805541964957071*^9, 3.8055419653370485`*^9}, {3.805644674432024*^9, 
   3.805644689326928*^9}, {3.8056447243434935`*^9, 3.805644724729763*^9}, {
   3.805648168765316*^9, 3.8056481756351786`*^9}, {3.8056539064228196`*^9, 
   3.8056539295463247`*^9}, {3.8056540668865805`*^9, 3.805654066984803*^9}, {
   3.805654110285739*^9, 3.805654110384491*^9}, {3.8056541556554327`*^9, 
   3.8056541557413416`*^9}, {3.8056542299500237`*^9, 3.8056542317812524`*^9}, 
   3.8056543099228535`*^9, {3.805654358269128*^9, 3.805654368009179*^9}, {
   3.8056544642616158`*^9, 3.805654465551602*^9}, {3.805654507577317*^9, 
   3.8056545108366966`*^9}, {3.805654584657906*^9, 3.8056545847659454`*^9}, 
   3.8056549428986197`*^9, {3.805690945881709*^9, 3.8056909504122095`*^9}, {
   3.805691129877775*^9, 3.805691133002037*^9}, {3.8056948777912235`*^9, 
   3.8056948891102767`*^9}, {3.8056949216317205`*^9, 3.805694927469806*^9}, {
   3.805695575019693*^9, 3.805695576097562*^9}, 3.8056977800217304`*^9, {
   3.8057111000260644`*^9, 3.805711157757343*^9}, {3.8057112680852766`*^9, 
   3.8057113099274597`*^9}, {3.805711641739091*^9, 3.8057116666802793`*^9}, {
   3.8057227237414885`*^9, 3.805722724199424*^9}, {3.8057227816882224`*^9, 
   3.805722782395424*^9}, {3.805722879128221*^9, 3.805722881555817*^9}, 
   3.805723053897018*^9, {3.8057231352221413`*^9, 3.8057231353216267`*^9}, {
   3.8057232185873413`*^9, 3.8057232294479685`*^9}, {3.805731032834529*^9, 
   3.8057310557155223`*^9}, {3.8057312754829855`*^9, 
   3.8057312910725603`*^9}, {3.8057313439970284`*^9, 
   3.8057315533814726`*^9}, {3.805732422724962*^9, 3.8057324827829056`*^9}, {
   3.805732523478693*^9, 3.805732566351097*^9}, {3.805732597747841*^9, 
   3.805732619790183*^9}, {3.8057328907882867`*^9, 3.8057328923865623`*^9}, 
   3.805732956917194*^9, {3.8057331542309875`*^9, 3.805733161061239*^9}, {
   3.8057333186123285`*^9, 3.8057333281107783`*^9}, {3.805733704947318*^9, 
   3.8057337290149565`*^9}, {3.8057340347674465`*^9, 3.805734061517826*^9}, {
   3.806824052626663*^9, 3.8068240788423967`*^9}, {3.8068245106946297`*^9, 
   3.8068245759051332`*^9}, 3.8068246410077033`*^9, {3.8068298246438456`*^9, 
   3.806829825862313*^9}, {3.80682986463428*^9, 3.806829893351037*^9}, {
   3.806829985886611*^9, 3.8068299908013783`*^9}, {3.8068300219848404`*^9, 
   3.8068300322142944`*^9}, {3.8068310804626465`*^9, 
   3.8068310841543207`*^9}, {3.8068311314800377`*^9, 
   3.8068311550544424`*^9}, {3.806834531093023*^9, 3.8068345339293685`*^9}, {
   3.8325751644273376`*^9, 3.8325751871987944`*^9}, {3.8325756728293104`*^9, 
   3.8325756729235*^9}, {3.8325758853851056`*^9, 3.8325758855100765`*^9}},
 CellLabel->
  "In[104]:=",ExpressionUUID->"a1c691ce-10bd-43d3-8a72-f9ec3c589df9"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"I", " ", "changed", " ", "this"}], " ", "*)"}]], "Input",
 CellChangeTimes->{{3.8513250383206863`*^9, 3.851325045595066*^9}},
 CellLabel->
  "In[105]:=",ExpressionUUID->"f87d4c61-799e-4958-9220-c01af9ac4888"],

Cell[BoxData[
 RowBox[{"v0", " ", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"Sqrt", "[", 
     RowBox[{"EE", "/", "s1"}], "]"}], "v0Q"}], "+", 
   RowBox[{
    RowBox[{"Sqrt", "[", 
     RowBox[{"EE", "/", "s2"}], "]"}], " ", 
    RowBox[{"vecsH", "[", 
     RowBox[{"[", "2", "]"}], "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.8054300877671957`*^9, 3.805430103659319*^9}, {
   3.805446089238859*^9, 3.8054460948553953`*^9}, {3.8054462036891036`*^9, 
   3.8054462396609955`*^9}, {3.8054849978394723`*^9, 
   3.8054850023515587`*^9}, {3.8055280684410477`*^9, 
   3.8055280715764627`*^9}, {3.8055404398412557`*^9, 
   3.8055404416350155`*^9}, {3.8055407072210875`*^9, 3.805540711415766*^9}, {
   3.805541384980008*^9, 3.805541385425804*^9}, {3.8055414420489264`*^9, 
   3.8055414421447935`*^9}, {3.8055417349923806`*^9, 
   3.8055417353302755`*^9}, {3.8055419067496076`*^9, 3.805541908060919*^9}, {
   3.805541964957071*^9, 3.8055419653370485`*^9}, {3.805644674432024*^9, 
   3.805644689326928*^9}, {3.8056447243434935`*^9, 3.805644724729763*^9}, {
   3.805648168765316*^9, 3.8056481756351786`*^9}, {3.8056539064228196`*^9, 
   3.8056539295463247`*^9}, {3.8056540668865805`*^9, 3.805654066984803*^9}, {
   3.805654110285739*^9, 3.805654110384491*^9}, {3.8056541556554327`*^9, 
   3.8056541557413416`*^9}, {3.8056542299500237`*^9, 3.8056542317812524`*^9}, 
   3.8056543099228535`*^9, {3.805654358269128*^9, 3.805654368009179*^9}, {
   3.8056544642616158`*^9, 3.805654465551602*^9}, {3.805654507577317*^9, 
   3.8056545108366966`*^9}, {3.805654584657906*^9, 3.8056545847659454`*^9}, 
   3.8056549428986197`*^9, {3.805690945881709*^9, 3.8056909504122095`*^9}, {
   3.805691129877775*^9, 3.805691133002037*^9}, {3.8056948777912235`*^9, 
   3.8056948891102767`*^9}, {3.8056949216317205`*^9, 3.805694927469806*^9}, {
   3.805695575019693*^9, 3.805695576097562*^9}, 3.8056977800217304`*^9, {
   3.8057111000260644`*^9, 3.805711157757343*^9}, {3.8057112680852766`*^9, 
   3.8057113099274597`*^9}, {3.805711641739091*^9, 3.8057116666802793`*^9}, {
   3.8057227237414885`*^9, 3.805722724199424*^9}, {3.8057227816882224`*^9, 
   3.805722782395424*^9}, {3.805722879128221*^9, 3.805722881555817*^9}, 
   3.805723053897018*^9, {3.8057231352221413`*^9, 3.8057231353216267`*^9}, {
   3.8057232185873413`*^9, 3.8057232294479685`*^9}, {3.805731032834529*^9, 
   3.8057310557155223`*^9}, {3.8057312754829855`*^9, 
   3.8057312910725603`*^9}, {3.8057313439970284`*^9, 
   3.8057315533814726`*^9}, {3.805732422724962*^9, 3.8057324827829056`*^9}, {
   3.805732523478693*^9, 3.805732566351097*^9}, {3.805732597747841*^9, 
   3.805732619790183*^9}, {3.8057328907882867`*^9, 3.8057328923865623`*^9}, 
   3.805732956917194*^9, {3.8057331542309875`*^9, 3.805733161061239*^9}, {
   3.8057333186123285`*^9, 3.8057333281107783`*^9}, {3.805733704947318*^9, 
   3.8057337290149565`*^9}, {3.8057340347674465`*^9, 3.805734061517826*^9}, {
   3.806824052626663*^9, 3.8068240788423967`*^9}, {3.8068245106946297`*^9, 
   3.8068245759051332`*^9}, 3.8068246410077033`*^9, {3.8068298246438456`*^9, 
   3.806829825862313*^9}, {3.80682986463428*^9, 3.806829893351037*^9}, {
   3.806829985886611*^9, 3.8068299908013783`*^9}, {3.8068300219848404`*^9, 
   3.8068300322142944`*^9}, {3.8068310804626465`*^9, 
   3.8068310841543207`*^9}, {3.8068311314800377`*^9, 3.806831157761469*^9}, 
   3.806831330014596*^9, 3.806863879471459*^9, 3.8068643360654078`*^9, 
   3.806864744813854*^9, {3.806915547855167*^9, 3.806915549941964*^9}, 
   3.806921952337719*^9, 3.806926694836336*^9, 3.807850012566468*^9, 
   3.807885202088396*^9, 3.8079515645928173`*^9, {3.8325751922553635`*^9, 
   3.8325751948435974`*^9}, {3.8325752991202545`*^9, 
   3.8325753022150774`*^9}, {3.832575381946123*^9, 3.832575382360649*^9}, {
   3.8325754504060645`*^9, 3.832575452057667*^9}, {3.8325755901287174`*^9, 
   3.8325755974853196`*^9}, {3.83257576215028*^9, 3.8325757622757163`*^9}, 
   3.8325758364750853`*^9, 3.8325759536919107`*^9, {3.832576045385001*^9, 
   3.832576046682138*^9}, {3.8325761267863336`*^9, 3.832576126872799*^9}, {
   3.83257643907055*^9, 3.832576460816413*^9}, {3.832576606559241*^9, 
   3.8325766147072144`*^9}, {3.832576699068243*^9, 3.8325767157323804`*^9}, {
   3.8325768900788803`*^9, 3.8325769081481776`*^9}, {3.832577494143618*^9, 
   3.832577494553171*^9}, {3.832577565494889*^9, 3.8325775658849716`*^9}, 
   3.832577615320489*^9, {3.832577709675062*^9, 3.832577709753294*^9}, {
   3.832577939084429*^9, 3.832577941310113*^9}, {3.8325780462835045`*^9, 
   3.8325780463610306`*^9}, {3.832578140901249*^9, 3.8325781511726103`*^9}, {
   3.8325782155468206`*^9, 3.832578255472268*^9}, {3.832578327264991*^9, 
   3.832578335183749*^9}, {3.832578428685932*^9, 3.8325784287270947`*^9}, {
   3.832578524474699*^9, 3.832578525592291*^9}, {3.8325786059440455`*^9, 
   3.8325786061201987`*^9}, {3.8325787899791193`*^9, 
   3.8325787903360963`*^9}, {3.832578933820199*^9, 3.832578933944813*^9}, {
   3.832582666146473*^9, 3.8325826689355*^9}, {3.832582804088271*^9, 
   3.832582804163849*^9}, {3.8325828906147327`*^9, 3.832582895586567*^9}, 
   3.851324794694065*^9, {3.8513249510732417`*^9, 3.851324951167224*^9}, {
   3.851325032844746*^9, 3.851325032907836*^9}, {3.851339674211543*^9, 
   3.8513396743725553`*^9}, {3.8513420840306826`*^9, 
   3.8513420847456093`*^9}, {3.851342280147701*^9, 3.8513422862154117`*^9}, 
   3.852370944016963*^9},
 CellLabel->
  "In[106]:=",ExpressionUUID->"9248b7f6-8275-41a2-b663-b24c111efc62"],

Cell[BoxData[
 RowBox[{"E1", "=", 
  RowBox[{
   FractionBox["1", "2"], 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"Proj1", ".", "v0"}], ")"}], ".", "G", ".", 
    RowBox[{"(", 
     RowBox[{"Proj1", ".", "v0"}], ")"}]}]}]}]], "Input",
 CellChangeTimes->{{3.8054300877671957`*^9, 3.805430103659319*^9}, {
   3.805446089238859*^9, 3.8054460948553953`*^9}, {3.8054462036891036`*^9, 
   3.8054462396609955`*^9}, {3.8054849978394723`*^9, 
   3.8054850023515587`*^9}, {3.8055280684410477`*^9, 
   3.8055280715764627`*^9}, {3.8055404398412557`*^9, 
   3.8055404416350155`*^9}, {3.8055407072210875`*^9, 3.805540711415766*^9}, {
   3.805541384980008*^9, 3.805541385425804*^9}, {3.8055414420489264`*^9, 
   3.8055414421447935`*^9}, {3.8055417349923806`*^9, 
   3.8055417353302755`*^9}, {3.8055419067496076`*^9, 3.805541908060919*^9}, {
   3.805541964957071*^9, 3.8055419653370485`*^9}, {3.805644674432024*^9, 
   3.805644689326928*^9}, {3.8056447243434935`*^9, 3.805644724729763*^9}, {
   3.805648168765316*^9, 3.8056481756351786`*^9}, {3.8056539064228196`*^9, 
   3.8056539295463247`*^9}, {3.8056540668865805`*^9, 3.805654066984803*^9}, {
   3.805654110285739*^9, 3.805654110384491*^9}, {3.8056541556554327`*^9, 
   3.8056541557413416`*^9}, {3.8056542299500237`*^9, 3.8056542317812524`*^9}, 
   3.8056543099228535`*^9, {3.805654358269128*^9, 3.805654368009179*^9}, {
   3.8056544642616158`*^9, 3.805654465551602*^9}, {3.805654507577317*^9, 
   3.8056545108366966`*^9}, {3.805654584657906*^9, 3.8056545847659454`*^9}, 
   3.8056549428986197`*^9, {3.805690945881709*^9, 3.8056909504122095`*^9}, {
   3.805691129877775*^9, 3.805691133002037*^9}, {3.8056948777912235`*^9, 
   3.8056948891102767`*^9}, {3.8056949216317205`*^9, 3.805694927469806*^9}, {
   3.805695575019693*^9, 3.805695576097562*^9}, 3.8056977800217304`*^9, {
   3.8057111000260644`*^9, 3.805711157757343*^9}, {3.8057112680852766`*^9, 
   3.8057113099274597`*^9}, {3.805711641739091*^9, 3.8057116666802793`*^9}, {
   3.8057227237414885`*^9, 3.805722724199424*^9}, {3.8057227816882224`*^9, 
   3.805722782395424*^9}, {3.805722879128221*^9, 3.805722881555817*^9}, 
   3.805723053897018*^9, {3.8057231352221413`*^9, 3.8057231353216267`*^9}, {
   3.8057232185873413`*^9, 3.8057232294479685`*^9}, {3.805731032834529*^9, 
   3.8057310557155223`*^9}, {3.8057312754829855`*^9, 
   3.8057312910725603`*^9}, {3.8057313439970284`*^9, 
   3.8057315533814726`*^9}, {3.805732422724962*^9, 3.8057324827829056`*^9}, {
   3.805732523478693*^9, 3.805732566351097*^9}, {3.805732597747841*^9, 
   3.805732619790183*^9}, {3.8057328907882867`*^9, 3.8057328923865623`*^9}, 
   3.805732956917194*^9, {3.8057331542309875`*^9, 3.805733161061239*^9}, {
   3.8057333186123285`*^9, 3.8057333281107783`*^9}, {3.805733704947318*^9, 
   3.8057337290149565`*^9}, {3.8057340347674465`*^9, 3.805734061517826*^9}, {
   3.806824052626663*^9, 3.8068240788423967`*^9}, {3.8068245106946297`*^9, 
   3.8068245759051332`*^9}, 3.8068246410077033`*^9, {3.8068298246438456`*^9, 
   3.806829825862313*^9}, {3.80682986463428*^9, 3.806829893351037*^9}, {
   3.806829985886611*^9, 3.8068299908013783`*^9}, {3.8068300219848404`*^9, 
   3.8068300322142944`*^9}, {3.8068310804626465`*^9, 
   3.8068310841543207`*^9}, {3.8068311314800377`*^9, 3.806831159922201*^9}},
 CellLabel->
  "In[107]:=",ExpressionUUID->"dfc9d0db-6d7d-4173-ad5f-99694d848453"],

Cell[BoxData[
 RowBox[{"E2", "=", 
  RowBox[{
   FractionBox["1", "2"], 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"Proj2", ".", "v0"}], ")"}], ".", "G", ".", 
    RowBox[{"(", 
     RowBox[{"Proj2", ".", "v0"}], ")"}]}]}]}]], "Input",
 CellChangeTimes->{{3.8054300877671957`*^9, 3.805430103659319*^9}, {
   3.805446089238859*^9, 3.8054460948553953`*^9}, {3.8054462036891036`*^9, 
   3.8054462396609955`*^9}, {3.8054849978394723`*^9, 
   3.8054850023515587`*^9}, {3.8055280684410477`*^9, 
   3.8055280715764627`*^9}, {3.8055404398412557`*^9, 
   3.8055404416350155`*^9}, {3.8055407072210875`*^9, 3.805540711415766*^9}, {
   3.805541384980008*^9, 3.805541385425804*^9}, {3.8055414420489264`*^9, 
   3.8055414421447935`*^9}, {3.8055417349923806`*^9, 
   3.8055417353302755`*^9}, {3.8055419067496076`*^9, 3.805541908060919*^9}, {
   3.805541964957071*^9, 3.8055419653370485`*^9}, {3.805644674432024*^9, 
   3.805644689326928*^9}, {3.8056447243434935`*^9, 3.805644724729763*^9}, {
   3.805648168765316*^9, 3.8056481756351786`*^9}, {3.8056539064228196`*^9, 
   3.8056539295463247`*^9}, {3.8056540668865805`*^9, 3.805654066984803*^9}, {
   3.805654110285739*^9, 3.805654110384491*^9}, {3.8056541556554327`*^9, 
   3.8056541557413416`*^9}, {3.8056542299500237`*^9, 3.8056542317812524`*^9}, 
   3.8056543099228535`*^9, {3.805654358269128*^9, 3.805654368009179*^9}, {
   3.8056544642616158`*^9, 3.805654465551602*^9}, {3.805654507577317*^9, 
   3.8056545108366966`*^9}, {3.805654584657906*^9, 3.8056545847659454`*^9}, 
   3.8056549428986197`*^9, {3.805690945881709*^9, 3.8056909504122095`*^9}, {
   3.805691129877775*^9, 3.805691133002037*^9}, {3.8056948777912235`*^9, 
   3.8056948891102767`*^9}, {3.8056949216317205`*^9, 3.805694927469806*^9}, {
   3.805695575019693*^9, 3.805695576097562*^9}, 3.8056977800217304`*^9, {
   3.8057111000260644`*^9, 3.805711157757343*^9}, {3.8057112680852766`*^9, 
   3.8057113099274597`*^9}, {3.805711641739091*^9, 3.8057116666802793`*^9}, {
   3.8057227237414885`*^9, 3.805722724199424*^9}, {3.8057227816882224`*^9, 
   3.805722782395424*^9}, {3.805722879128221*^9, 3.805722881555817*^9}, 
   3.805723053897018*^9, {3.8057231352221413`*^9, 3.8057231353216267`*^9}, {
   3.8057232185873413`*^9, 3.8057232294479685`*^9}, {3.805731032834529*^9, 
   3.8057310557155223`*^9}, {3.8057312754829855`*^9, 
   3.8057312910725603`*^9}, {3.8057313439970284`*^9, 
   3.8057315533814726`*^9}, {3.805732422724962*^9, 3.8057324827829056`*^9}, {
   3.805732523478693*^9, 3.805732566351097*^9}, {3.805732597747841*^9, 
   3.805732619790183*^9}, {3.8057328907882867`*^9, 3.8057328923865623`*^9}, 
   3.805732956917194*^9, {3.8057331542309875`*^9, 3.805733161061239*^9}, {
   3.8057333186123285`*^9, 3.8057333281107783`*^9}, {3.805733704947318*^9, 
   3.8057337290149565`*^9}, {3.8057340347674465`*^9, 3.805734061517826*^9}, {
   3.806824052626663*^9, 3.8068240788423967`*^9}, {3.8068245106946297`*^9, 
   3.8068245759051332`*^9}, 3.8068246410077033`*^9, {3.8068298246438456`*^9, 
   3.806829825862313*^9}, {3.80682986463428*^9, 3.806829893351037*^9}, {
   3.806829985886611*^9, 3.8068299908013783`*^9}, {3.8068300219848404`*^9, 
   3.8068300322142944`*^9}, {3.8068310804626465`*^9, 
   3.8068310841543207`*^9}, {3.8068311314800377`*^9, 3.8068312061057973`*^9}},
 CellLabel->
  "In[108]:=",ExpressionUUID->"77ec5743-383c-4734-b82c-5b2a88ad73dd"],

Cell[BoxData[
 RowBox[{"E3", "=", 
  RowBox[{
   FractionBox["1", "2"], 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"Proj3", ".", "v0"}], ")"}], ".", "G", ".", 
    RowBox[{"(", 
     RowBox[{"Proj3", ".", "v0"}], ")"}]}]}]}]], "Input",
 CellChangeTimes->{{3.8054300877671957`*^9, 3.805430103659319*^9}, {
   3.805446089238859*^9, 3.8054460948553953`*^9}, {3.8054462036891036`*^9, 
   3.8054462396609955`*^9}, {3.8054849978394723`*^9, 
   3.8054850023515587`*^9}, {3.8055280684410477`*^9, 
   3.8055280715764627`*^9}, {3.8055404398412557`*^9, 
   3.8055404416350155`*^9}, {3.8055407072210875`*^9, 3.805540711415766*^9}, {
   3.805541384980008*^9, 3.805541385425804*^9}, {3.8055414420489264`*^9, 
   3.8055414421447935`*^9}, {3.8055417349923806`*^9, 
   3.8055417353302755`*^9}, {3.8055419067496076`*^9, 3.805541908060919*^9}, {
   3.805541964957071*^9, 3.8055419653370485`*^9}, {3.805644674432024*^9, 
   3.805644689326928*^9}, {3.8056447243434935`*^9, 3.805644724729763*^9}, {
   3.805648168765316*^9, 3.8056481756351786`*^9}, {3.8056539064228196`*^9, 
   3.8056539295463247`*^9}, {3.8056540668865805`*^9, 3.805654066984803*^9}, {
   3.805654110285739*^9, 3.805654110384491*^9}, {3.8056541556554327`*^9, 
   3.8056541557413416`*^9}, {3.8056542299500237`*^9, 3.8056542317812524`*^9}, 
   3.8056543099228535`*^9, {3.805654358269128*^9, 3.805654368009179*^9}, {
   3.8056544642616158`*^9, 3.805654465551602*^9}, {3.805654507577317*^9, 
   3.8056545108366966`*^9}, {3.805654584657906*^9, 3.8056545847659454`*^9}, 
   3.8056549428986197`*^9, {3.805690945881709*^9, 3.8056909504122095`*^9}, {
   3.805691129877775*^9, 3.805691133002037*^9}, {3.8056948777912235`*^9, 
   3.8056948891102767`*^9}, {3.8056949216317205`*^9, 3.805694927469806*^9}, {
   3.805695575019693*^9, 3.805695576097562*^9}, 3.8056977800217304`*^9, {
   3.8057111000260644`*^9, 3.805711157757343*^9}, {3.8057112680852766`*^9, 
   3.8057113099274597`*^9}, {3.805711641739091*^9, 3.8057116666802793`*^9}, {
   3.8057227237414885`*^9, 3.805722724199424*^9}, {3.8057227816882224`*^9, 
   3.805722782395424*^9}, {3.805722879128221*^9, 3.805722881555817*^9}, 
   3.805723053897018*^9, {3.8057231352221413`*^9, 3.8057231353216267`*^9}, {
   3.8057232185873413`*^9, 3.8057232294479685`*^9}, {3.805731032834529*^9, 
   3.8057310557155223`*^9}, {3.8057312754829855`*^9, 
   3.8057312910725603`*^9}, {3.8057313439970284`*^9, 
   3.8057315533814726`*^9}, {3.805732422724962*^9, 3.8057324827829056`*^9}, {
   3.805732523478693*^9, 3.805732566351097*^9}, {3.805732597747841*^9, 
   3.805732619790183*^9}, {3.8057328907882867`*^9, 3.8057328923865623`*^9}, 
   3.805732956917194*^9, {3.8057331542309875`*^9, 3.805733161061239*^9}, {
   3.8057333186123285`*^9, 3.8057333281107783`*^9}, {3.805733704947318*^9, 
   3.8057337290149565`*^9}, {3.8057340347674465`*^9, 3.805734061517826*^9}, {
   3.806824052626663*^9, 3.8068240788423967`*^9}, {3.8068245106946297`*^9, 
   3.8068245759051332`*^9}, 3.8068246410077033`*^9, {3.8068298246438456`*^9, 
   3.806829825862313*^9}, {3.80682986463428*^9, 3.806829893351037*^9}, {
   3.806829985886611*^9, 3.8068299908013783`*^9}, {3.8068300219848404`*^9, 
   3.8068300322142944`*^9}, {3.8068310804626465`*^9, 
   3.8068310841543207`*^9}, {3.8068311314800377`*^9, 3.8068312061057973`*^9}},
 CellLabel->
  "In[109]:=",ExpressionUUID->"6da000da-e3af-45ea-965a-e7767e434474"],

Cell[BoxData[
 RowBox[{"E4", "=", 
  RowBox[{
   FractionBox["1", "2"], 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"Proj4", ".", "v0"}], ")"}], ".", "G", ".", 
    RowBox[{"(", 
     RowBox[{"Proj4", ".", "v0"}], ")"}]}]}]}]], "Input",
 CellChangeTimes->{{3.8054300877671957`*^9, 3.805430103659319*^9}, {
   3.805446089238859*^9, 3.8054460948553953`*^9}, {3.8054462036891036`*^9, 
   3.8054462396609955`*^9}, {3.8054849978394723`*^9, 
   3.8054850023515587`*^9}, {3.8055280684410477`*^9, 
   3.8055280715764627`*^9}, {3.8055404398412557`*^9, 
   3.8055404416350155`*^9}, {3.8055407072210875`*^9, 3.805540711415766*^9}, {
   3.805541384980008*^9, 3.805541385425804*^9}, {3.8055414420489264`*^9, 
   3.8055414421447935`*^9}, {3.8055417349923806`*^9, 
   3.8055417353302755`*^9}, {3.8055419067496076`*^9, 3.805541908060919*^9}, {
   3.805541964957071*^9, 3.8055419653370485`*^9}, {3.805644674432024*^9, 
   3.805644689326928*^9}, {3.8056447243434935`*^9, 3.805644724729763*^9}, {
   3.805648168765316*^9, 3.8056481756351786`*^9}, {3.8056539064228196`*^9, 
   3.8056539295463247`*^9}, {3.8056540668865805`*^9, 3.805654066984803*^9}, {
   3.805654110285739*^9, 3.805654110384491*^9}, {3.8056541556554327`*^9, 
   3.8056541557413416`*^9}, {3.8056542299500237`*^9, 3.8056542317812524`*^9}, 
   3.8056543099228535`*^9, {3.805654358269128*^9, 3.805654368009179*^9}, {
   3.8056544642616158`*^9, 3.805654465551602*^9}, {3.805654507577317*^9, 
   3.8056545108366966`*^9}, {3.805654584657906*^9, 3.8056545847659454`*^9}, 
   3.8056549428986197`*^9, {3.805690945881709*^9, 3.8056909504122095`*^9}, {
   3.805691129877775*^9, 3.805691133002037*^9}, {3.8056948777912235`*^9, 
   3.8056948891102767`*^9}, {3.8056949216317205`*^9, 3.805694927469806*^9}, {
   3.805695575019693*^9, 3.805695576097562*^9}, 3.8056977800217304`*^9, {
   3.8057111000260644`*^9, 3.805711157757343*^9}, {3.8057112680852766`*^9, 
   3.8057113099274597`*^9}, {3.805711641739091*^9, 3.8057116666802793`*^9}, {
   3.8057227237414885`*^9, 3.805722724199424*^9}, {3.8057227816882224`*^9, 
   3.805722782395424*^9}, {3.805722879128221*^9, 3.805722881555817*^9}, 
   3.805723053897018*^9, {3.8057231352221413`*^9, 3.8057231353216267`*^9}, {
   3.8057232185873413`*^9, 3.8057232294479685`*^9}, {3.805731032834529*^9, 
   3.8057310557155223`*^9}, {3.8057312754829855`*^9, 
   3.8057312910725603`*^9}, {3.8057313439970284`*^9, 
   3.8057315533814726`*^9}, {3.805732422724962*^9, 3.8057324827829056`*^9}, {
   3.805732523478693*^9, 3.805732566351097*^9}, {3.805732597747841*^9, 
   3.805732619790183*^9}, {3.8057328907882867`*^9, 3.8057328923865623`*^9}, 
   3.805732956917194*^9, {3.8057331542309875`*^9, 3.805733161061239*^9}, {
   3.8057333186123285`*^9, 3.8057333281107783`*^9}, {3.805733704947318*^9, 
   3.8057337290149565`*^9}, {3.8057340347674465`*^9, 3.805734061517826*^9}, {
   3.806824052626663*^9, 3.8068240788423967`*^9}, {3.8068245106946297`*^9, 
   3.8068245759051332`*^9}, 3.8068246410077033`*^9, {3.8068298246438456`*^9, 
   3.806829825862313*^9}, {3.80682986463428*^9, 3.806829893351037*^9}, {
   3.806829985886611*^9, 3.8068299908013783`*^9}, {3.8068300219848404`*^9, 
   3.8068300322142944`*^9}, {3.8068310804626465`*^9, 
   3.8068310841543207`*^9}, {3.8068311314800377`*^9, 3.806831181529587*^9}},
 CellLabel->
  "In[110]:=",ExpressionUUID->"d798ae0e-75d6-4306-82d6-fcc41427a797"],

Cell[BoxData[
 RowBox[{"E5", "=", 
  RowBox[{
   FractionBox["1", "2"], 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"Proj5", ".", "v0"}], ")"}], ".", "G", ".", 
    RowBox[{"(", 
     RowBox[{"Proj5", ".", "v0"}], ")"}]}]}]}]], "Input",
 CellChangeTimes->{{3.8054300877671957`*^9, 3.805430103659319*^9}, {
   3.805446089238859*^9, 3.8054460948553953`*^9}, {3.8054462036891036`*^9, 
   3.8054462396609955`*^9}, {3.8054849978394723`*^9, 
   3.8054850023515587`*^9}, {3.8055280684410477`*^9, 
   3.8055280715764627`*^9}, {3.8055404398412557`*^9, 
   3.8055404416350155`*^9}, {3.8055407072210875`*^9, 3.805540711415766*^9}, {
   3.805541384980008*^9, 3.805541385425804*^9}, {3.8055414420489264`*^9, 
   3.8055414421447935`*^9}, {3.8055417349923806`*^9, 
   3.8055417353302755`*^9}, {3.8055419067496076`*^9, 3.805541908060919*^9}, {
   3.805541964957071*^9, 3.8055419653370485`*^9}, {3.805644674432024*^9, 
   3.805644689326928*^9}, {3.8056447243434935`*^9, 3.805644724729763*^9}, {
   3.805648168765316*^9, 3.8056481756351786`*^9}, {3.8056539064228196`*^9, 
   3.8056539295463247`*^9}, {3.8056540668865805`*^9, 3.805654066984803*^9}, {
   3.805654110285739*^9, 3.805654110384491*^9}, {3.8056541556554327`*^9, 
   3.8056541557413416`*^9}, {3.8056542299500237`*^9, 3.8056542317812524`*^9}, 
   3.8056543099228535`*^9, {3.805654358269128*^9, 3.805654368009179*^9}, {
   3.8056544642616158`*^9, 3.805654465551602*^9}, {3.805654507577317*^9, 
   3.8056545108366966`*^9}, {3.805654584657906*^9, 3.8056545847659454`*^9}, 
   3.8056549428986197`*^9, {3.805690945881709*^9, 3.8056909504122095`*^9}, {
   3.805691129877775*^9, 3.805691133002037*^9}, {3.8056948777912235`*^9, 
   3.8056948891102767`*^9}, {3.8056949216317205`*^9, 3.805694927469806*^9}, {
   3.805695575019693*^9, 3.805695576097562*^9}, 3.8056977800217304`*^9, {
   3.8057111000260644`*^9, 3.805711157757343*^9}, {3.8057112680852766`*^9, 
   3.8057113099274597`*^9}, {3.805711641739091*^9, 3.8057116666802793`*^9}, {
   3.8057227237414885`*^9, 3.805722724199424*^9}, {3.8057227816882224`*^9, 
   3.805722782395424*^9}, {3.805722879128221*^9, 3.805722881555817*^9}, 
   3.805723053897018*^9, {3.8057231352221413`*^9, 3.8057231353216267`*^9}, {
   3.8057232185873413`*^9, 3.8057232294479685`*^9}, {3.805731032834529*^9, 
   3.8057310557155223`*^9}, {3.8057312754829855`*^9, 
   3.8057312910725603`*^9}, {3.8057313439970284`*^9, 
   3.8057315533814726`*^9}, {3.805732422724962*^9, 3.8057324827829056`*^9}, {
   3.805732523478693*^9, 3.805732566351097*^9}, {3.805732597747841*^9, 
   3.805732619790183*^9}, {3.8057328907882867`*^9, 3.8057328923865623`*^9}, 
   3.805732956917194*^9, {3.8057331542309875`*^9, 3.805733161061239*^9}, {
   3.8057333186123285`*^9, 3.8057333281107783`*^9}, {3.805733704947318*^9, 
   3.8057337290149565`*^9}, {3.8057340347674465`*^9, 3.805734061517826*^9}, {
   3.806824052626663*^9, 3.8068240788423967`*^9}, {3.8068245106946297`*^9, 
   3.8068245759051332`*^9}, 3.8068246410077033`*^9, {3.8068298246438456`*^9, 
   3.806829825862313*^9}, {3.80682986463428*^9, 3.806829893351037*^9}, {
   3.806829985886611*^9, 3.8068299908013783`*^9}, {3.8068300219848404`*^9, 
   3.8068300322142944`*^9}, {3.8068310804626465`*^9, 
   3.8068310841543207`*^9}, {3.8068311314800377`*^9, 3.806831181529587*^9}, 
   3.8068312156255608`*^9},
 CellLabel->
  "In[111]:=",ExpressionUUID->"cc43dc14-9a1d-44e6-8f43-058930500451"],

Cell[BoxData[
 RowBox[{"\[Theta]ast", "=", 
  RowBox[{"E2", "/", 
   RowBox[{"w2HR", "[", 
    RowBox[{"-", "1"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.8068345615408545`*^9, 3.806834580024466*^9}, 
   3.806864552812235*^9},
 CellLabel->
  "In[112]:=",ExpressionUUID->"06adbcb6-773a-4081-8410-cda966de50c4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Potential", " ", "correction"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Vweakt", "[", "\[Theta]_", "]"}], ":=", " ", 
     RowBox[{"1.116", "-", 
      RowBox[{"1.462", " ", 
       RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "-", 
      RowBox[{"1.578", " ", 
       RowBox[{
        RowBox[{"Cos", "[", "\[Theta]", "]"}], "^", "2"}]}], "+", 
      RowBox[{"0.368", " ", 
       RowBox[{
        RowBox[{"Cos", "[", "\[Theta]", "]"}], "^", "3"}]}], "+", 
      RowBox[{"3.156", " ", 
       RowBox[{
        RowBox[{"Cos", "[", "\[Theta]", "]"}], "^", "4"}]}], "+", 
      RowBox[{"3.788", " ", 
       RowBox[{
        RowBox[{"Cos", "[", "\[Theta]", "]"}], "^", "5"}]}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"min", " ", "=", 
     RowBox[{
      RowBox[{"NMinimize", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Vweakt", "[", "\[Theta]", "]"}], "+", 
          RowBox[{"\[Theta]ast", " ", 
           RowBox[{"w2HR", "[", "x", "]"}]}]}], "/.", 
         RowBox[{"x", "\[Rule]", " ", 
          RowBox[{"Cos", "[", "\[Theta]", "]"}]}]}], ",", "\[Theta]"}], "]"}],
       "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"plot1", "=", 
     RowBox[{"Plot", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"\[Theta]ast", " ", 
         RowBox[{"w2HR", "[", "x", "]"}]}], "/.", 
        RowBox[{"x", "\[Rule]", " ", 
         RowBox[{"Cos", "[", "\[Theta]", "]"}]}]}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Theta]", ",", "0", ",", 
         RowBox[{"2", "\[Pi]"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"plot2", "=", 
     RowBox[{"Plot", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Vweakt", "[", "\[Theta]", "]"}], ",", 
         RowBox[{
          RowBox[{"Vweakt", "[", "\[Theta]", "]"}], "+", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[Theta]ast", " ", 
             RowBox[{"w2HR", "[", "x", "]"}]}], "/.", 
            RowBox[{"x", "\[Rule]", " ", 
             RowBox[{"Cos", "[", "\[Theta]", "]"}]}]}], ")"}], "-", "min"}]}],
         "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Theta]", ",", "0", ",", 
         RowBox[{"2", "\[Pi]"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"GraphicsRow", "[", 
    RowBox[{"{", 
     RowBox[{"plot1", ",", " ", "plot2"}], "}"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.801653098832529*^9, 3.801653111104938*^9}, {
   3.8016531580913544`*^9, 3.801653167440103*^9}, {3.801653242445004*^9, 
   3.801653250582494*^9}, {3.8016533299091597`*^9, 3.801653334128668*^9}, 
   3.8016601153113565`*^9, {3.801660858673152*^9, 3.801660886347554*^9}, {
   3.801661286735576*^9, 3.8016612877659473`*^9}, 3.80183354907638*^9, {
   3.801833742261382*^9, 3.8018337506615744`*^9}, {3.8018340241121693`*^9, 
   3.801834024314809*^9}, {3.805104624374445*^9, 3.8051046330069284`*^9}, {
   3.8051926050609884`*^9, 3.80519260874051*^9}, {3.8052769598615065`*^9, 
   3.8052769680730133`*^9}, {3.8054280181452503`*^9, 3.8054280351361537`*^9}, 
   3.805429665228632*^9, {3.805711367990568*^9, 3.8057114419745846`*^9}, {
   3.8057116711890435`*^9, 3.8057116724767847`*^9}, {3.805732897781682*^9, 
   3.805732901265766*^9}, {3.8057329534491887`*^9, 3.8057329546423473`*^9}, {
   3.805733156406415*^9, 3.805733158199645*^9}, {3.8057333305450926`*^9, 
   3.8057333316011724`*^9}, 3.8068345531276855`*^9, {3.806864069755339*^9, 
   3.8068641419178276`*^9}, {3.8068642411795034`*^9, 
   3.8068642756713276`*^9}, {3.8068645500812607`*^9, 
   3.8068645504525657`*^9}, {3.808236203677898*^9, 3.8082362051939573`*^9}, {
   3.808236238407342*^9, 3.808236239630806*^9}, {3.8082370550970535`*^9, 
   3.8082370563950567`*^9}, 3.851339721150075*^9},
 CellLabel->
  "In[113]:=",ExpressionUUID->"f6ab9d09-df3b-4753-9e07-5360b3849896"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Calculate", " ", "simulation"}], "*)"}], "\n", 
  RowBox[{
   RowBox[{
    RowBox[{
    "Needs", "[", "\"\<DifferentialEquations`NDSolveProblems`\>\"", "]"}], 
    ";"}], "\n", 
   RowBox[{
    RowBox[{
    "Needs", "[", "\"\<DifferentialEquations`NDSolveUtilities`\>\"", "]"}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"p1", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"p11", "[", "t", "]"}], ",", " ", 
       RowBox[{"p12", "[", "t", "]"}], ",", " ", 
       RowBox[{"p13", "[", "t", "]"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"p2", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"p21", "[", "t", "]"}], ",", " ", 
       RowBox[{"p22", "[", "t", "]"}], ",", " ", 
       RowBox[{"p23", "[", "t", "]"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"p3", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"p31", "[", "t", "]"}], ",", " ", 
       RowBox[{"p32", "[", "t", "]"}], ",", " ", 
       RowBox[{"p33", "[", "t", "]"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"p4", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"p41", "[", "t", "]"}], ",", " ", 
       RowBox[{"p42", "[", "t", "]"}], ",", " ", 
       RowBox[{"p43", "[", "t", "]"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"pos", "=", 
     RowBox[{"Join", "[", 
      RowBox[{"q1", ",", " ", "q2", ",", " ", "q3", ",", " ", "q4"}], "]"}]}],
     ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"mom", "=", 
     RowBox[{"Join", "[", 
      RowBox[{"p1", ",", "p2", ",", "p3", ",", "p4"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"initq", "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"pos", "/.", 
        RowBox[{"t", "\[Rule]", "0"}]}], ")"}], "\[Equal]", "q0"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"initp", "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"mom", "/.", 
        RowBox[{"t", "\[Rule]", "0"}]}], ")"}], "\[Equal]", 
      RowBox[{"G", ".", "v0"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"eps", "=", "0.5"}], ";"}], 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"0.5", "^", "5"}], ";"}], " ", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{
       RowBox[{"Up", " ", "to", " ", "n"}], "=", "10"}], ",", " ", 
      RowBox[{
      "here", " ", "20", " ", "time", " ", "steps", " ", "per", " ", 
       "osc"}]}], "*)"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Vstrong", " ", "=", " ", 
     RowBox[{
      RowBox[{"1", "/", 
       RowBox[{"eps", "^", "2"}]}], " ", "Vstrong"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"eqs1", "=", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{"pos", ",", "t"}], "]"}], "\[Equal]", 
      RowBox[{
       RowBox[{"Inverse", "[", "G", "]"}], ".", "mom"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"eqs2", "=", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{"mom", ",", "t"}], "]"}], "\[Equal]", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"D", "[", 
         RowBox[{"Vweak", ",", " ", 
          RowBox[{"{", "pos", "}"}]}], "]"}]}], "-", 
       RowBox[{"D", "[", 
        RowBox[{"Vstrong", ",", 
         RowBox[{"{", "pos", "}"}]}], "]"}]}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Ham", " ", "=", " ", 
     RowBox[{
      RowBox[{"0.5", 
       RowBox[{"mom", ".", 
        RowBox[{"Inverse", "[", "G", "]"}], ".", "mom"}]}], "+", "Vweak", "+",
       "Vstrong"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"tmax", "=", "5"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"step", "=", 
     RowBox[{"0.5", "*", 
      RowBox[{"10", "^", 
       RowBox[{"-", "4"}]}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"sol", "=", 
     RowBox[{"NDSolve", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"eqs1", ",", " ", "eqs2", ",", "initq", ",", "initp"}], "}"}],
        ",", 
       RowBox[{"Join", "[", 
        RowBox[{"pos", ",", "mom"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"t", ",", "0", ",", "tmax"}], "}"}], ",", 
       RowBox[{"Method", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"\"\<SymplecticPartitionedRungeKutta\>\"", ",", 
          RowBox[{"\"\<DifferenceOrder\>\"", "\[Rule]", "10"}], ",", 
          RowBox[{"\"\<PositionVariables\>\"", "\[Rule]", "pos"}]}], "}"}]}], 
       ",", 
       RowBox[{"StartingStepSize", "\[Rule]", "step"}], ",", 
       RowBox[{"MaxSteps", "\[Rule]", "240000"}], ",", " ", 
       RowBox[{"MaxStepSize", "\[Rule]", "step"}]}], "]"}]}], ";"}], "\n", 
   RowBox[{"(*", 
    RowBox[{"Check", " ", "invariant", " ", "energy"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"plot1", "=", " ", 
     RowBox[{"InvariantErrorPlot", "[", 
      RowBox[{"Ham", ",", 
       RowBox[{"Join", "[", 
        RowBox[{"pos", ",", "mom"}], "]"}], ",", "t", ",", "sol", ",", 
       RowBox[{"PlotStyle", "\[Rule]", "Blue"}]}], "]"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.8016471894731026`*^9, 3.801647196821004*^9}, {
   3.801647771139757*^9, 3.801647781026511*^9}, 3.801663206205542*^9, {
   3.80510497987774*^9, 3.80510497987774*^9}, {3.8051053038910985`*^9, 
   3.8051053186009254`*^9}, 3.805105718757161*^9, {3.8051898705164785`*^9, 
   3.8051898902928705`*^9}, {3.805190876348607*^9, 3.8051908769642167`*^9}, {
   3.8052035370833025`*^9, 3.805203537673401*^9}, {3.8052088811776314`*^9, 
   3.8052088839263515`*^9}, {3.8052113535282345`*^9, 
   3.8052113618570004`*^9}, {3.80529613974457*^9, 3.8052961403069763`*^9}, {
   3.8052964170791883`*^9, 3.805296417230777*^9}, {3.8053718153002405`*^9, 
   3.8053718181764708`*^9}, {3.805437326761359*^9, 3.80543732811926*^9}, {
   3.805437368518725*^9, 3.805437369510745*^9}, 3.805437643545618*^9, 
   3.8054392205897903`*^9, 3.8054392882081165`*^9, {3.8055579077723513`*^9, 
   3.8055579190003743`*^9}, {3.805557957119267*^9, 3.8055579599309053`*^9}, {
   3.805718724165143*^9, 3.805718734639346*^9}, {3.805718789461291*^9, 
   3.8057188157761526`*^9}, {3.805718893445157*^9, 3.805718977018315*^9}, {
   3.805719064669505*^9, 3.805719202385016*^9}, 3.8057192439005857`*^9, {
   3.8057193230254955`*^9, 3.805719471507056*^9}, {3.80571960866626*^9, 
   3.805719683353018*^9}, {3.8057197538832684`*^9, 3.8057198136574044`*^9}, 
   3.805719992290845*^9, {3.805720048382363*^9, 3.8057200754535027`*^9}, {
   3.805720137522323*^9, 3.805720137607193*^9}, {3.8057217533017497`*^9, 
   3.805721753584597*^9}, {3.8057219270709286`*^9, 3.805721962813777*^9}, {
   3.8057306200572042`*^9, 3.8057306378564763`*^9}, {3.8068636896360292`*^9, 
   3.806863689741259*^9}, {3.806865426261405*^9, 3.806865446941536*^9}, {
   3.806865748831541*^9, 3.806865748947209*^9}, {3.806865805653457*^9, 
   3.80686580575659*^9}, {3.8068658917280283`*^9, 3.806865891851069*^9}, {
   3.8068659732135553`*^9, 3.806865973347339*^9}, {3.806867063631533*^9, 
   3.8068670638637786`*^9}, {3.806867235000126*^9, 3.806867235990477*^9}, {
   3.806867314318519*^9, 3.8068673144402456`*^9}, {3.8068674530828424`*^9, 
   3.806867481181896*^9}, {3.8068676690165577`*^9, 3.806867669123467*^9}, {
   3.8068677699115715`*^9, 3.806867770025112*^9}, {3.8068678901461706`*^9, 
   3.8068678902875643`*^9}, {3.8068680366874027`*^9, 3.806868036785141*^9}, {
   3.806912799697186*^9, 3.8069128043825483`*^9}, {3.806914963253441*^9, 
   3.806914963378372*^9}, {3.806915109850943*^9, 3.8069151099421663`*^9}, {
   3.806915191670393*^9, 3.806915191773828*^9}, {3.806915276896682*^9, 
   3.806915276980833*^9}, {3.8069153728032975`*^9, 3.806915405912307*^9}, {
   3.806915487189483*^9, 3.8069154909083047`*^9}, {3.806915659368565*^9, 
   3.806915659462678*^9}, {3.8069157548423147`*^9, 3.806915754953126*^9}, {
   3.8069158620196977`*^9, 3.806915862103749*^9}, {3.8069159594304686`*^9, 
   3.8069159594874716`*^9}, {3.8069160625389376`*^9, 
   3.8069160629020767`*^9}, {3.8069219610970306`*^9, 
   3.8069219613802056`*^9}, {3.8069224515077405`*^9, 3.80692245161658*^9}, {
   3.80692254903421*^9, 3.8069225491754494`*^9}, {3.806922685686948*^9, 
   3.806922685800251*^9}, {3.8069227841609955`*^9, 3.80692278424968*^9}, {
   3.806926900567642*^9, 3.806926902570459*^9}, 3.80788517608617*^9, {
   3.807942939879624*^9, 3.80794294170076*^9}, {3.8082347514994383`*^9, 
   3.808234756577961*^9}, {3.8082854839563847`*^9, 3.808285484065734*^9}, {
   3.808285592930608*^9, 3.8082856219081383`*^9}, {3.8082856524877996`*^9, 
   3.808285656088132*^9}, {3.8082858366026196`*^9, 3.8082858426121397`*^9}, 
   3.808285942040844*^9, {3.8082859752039557`*^9, 3.8082859759935236`*^9}, {
   3.8082864556261244`*^9, 3.808286457720224*^9}, {3.8082865393604107`*^9, 
   3.808286540973384*^9}, {3.8082866705954475`*^9, 3.8082866800658913`*^9}, {
   3.808286946368478*^9, 3.808286963712571*^9}, {3.8082870415241947`*^9, 
   3.8082870592259226`*^9}, {3.8082874803169403`*^9, 3.808287481509262*^9}, {
   3.808287693025045*^9, 3.8082876950577545`*^9}, {3.808287826598489*^9, 
   3.808287841248704*^9}, {3.8082881226653304`*^9, 3.8082881227606597`*^9}, {
   3.8082885079612246`*^9, 3.808288585762746*^9}, {3.8082887089477663`*^9, 
   3.8082887093328238`*^9}, {3.8082887535287156`*^9, 3.808288753612128*^9}, {
   3.808288962248424*^9, 3.8082889669309444`*^9}, {3.8082902933299274`*^9, 
   3.8082902934663224`*^9}, {3.8082905313438635`*^9, 
   3.8082905314649286`*^9}, {3.8082927885986304`*^9, 3.808292788957304*^9}, {
   3.8082928973812437`*^9, 3.808292897443322*^9}, {3.8082929500697527`*^9, 
   3.8082929526008143`*^9}, {3.808312953208866*^9, 3.80831296626647*^9}, {
   3.8325789454110613`*^9, 3.832578945852745*^9}, {3.8325826448907447`*^9, 
   3.832582645545973*^9}, {3.832583000982232*^9, 3.8325830054478874`*^9}, {
   3.832583048182624*^9, 3.8325830485069203`*^9}, {3.832583255263403*^9, 
   3.832583258607873*^9}, {3.833460458594852*^9, 3.8334604587515025`*^9}, {
   3.8336940784167614`*^9, 3.8336940788494806`*^9}, {3.83369427969744*^9, 
   3.8336942799473886`*^9}, {3.8513246470561686`*^9, 
   3.8513246548143067`*^9}, {3.8513396859691534`*^9, 3.851339686094999*^9}},
 CellLabel->
  "In[118]:=",ExpressionUUID->"18dfc54f-293f-4642-9db9-5f36a65c5253"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Check", " ", "mean", " ", "distances"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Q1", "[", "t_", "]"}], "=", 
     RowBox[{"First", "[", 
      RowBox[{"q1", "/.", "sol"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Q2", "[", "t_", "]"}], "=", 
     RowBox[{"First", "[", 
      RowBox[{"q2", "/.", "sol"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Q3", "[", "t_", "]"}], "=", 
     RowBox[{"First", "[", 
      RowBox[{"q3", "/.", "sol"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Q4", "[", "t_", "]"}], "=", 
     RowBox[{"First", "[", 
      RowBox[{"q4", "/.", "sol"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"P1", "[", "t_", "]"}], "=", 
     RowBox[{"First", "[", 
      RowBox[{"p1", "/.", "sol"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"P2", "[", "t_", "]"}], "=", 
     RowBox[{"First", "[", 
      RowBox[{"p2", "/.", "sol"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"P3", "[", "t_", "]"}], "=", 
     RowBox[{"First", "[", 
      RowBox[{"p3", "/.", "sol"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"P4", "[", "t_", "]"}], "=", 
     RowBox[{"First", "[", 
      RowBox[{"p4", "/.", "sol"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"points", " ", "=", " ", 
     RowBox[{"Range", "[", 
      RowBox[{"0", ",", "tmax", ",", "step"}], "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.8057213564537444`*^9, 3.805721385782297*^9}, {
  3.8057215350538445`*^9, 3.805721588141363*^9}, {3.805721691382245*^9, 
  3.805721695182036*^9}, {3.805721914556063*^9, 3.805721914771674*^9}},
 CellLabel->
  "In[137]:=",ExpressionUUID->"163077aa-f37a-4873-bfec-27962e210256"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Check", " ", "invariant", " ", "linear", " ", "momentum"}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"linmon", " ", "=", " ", 
     RowBox[{"Norm", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"P1", "'"}], "[", "t", "]"}], "+", 
       RowBox[{
        RowBox[{"P2", "'"}], "[", "t", "]"}], "+", 
       RowBox[{
        RowBox[{"P3", "'"}], "[", "t", "]"}], "+", 
       RowBox[{
        RowBox[{"P4", "'"}], "[", "t", "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"plot2", " ", "=", " ", 
     RowBox[{"InvariantErrorPlot", "[", 
      RowBox[{"linmon", ",", 
       RowBox[{"Join", "[", 
        RowBox[{"pos", ",", "mom"}], "]"}], ",", "t", ",", "sol", ",", 
       RowBox[{"PlotStyle", "\[Rule]", "Blue"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Check", " ", "conservation", " ", "of", " ", "angular", " ", 
     "momentum"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"angmom", " ", "=", " ", 
     RowBox[{"Norm", "[", 
      RowBox[{
       RowBox[{"Cross", "[", 
        RowBox[{
         RowBox[{"Q1", "[", "t", "]"}], ",", 
         RowBox[{
          RowBox[{"P1", "'"}], "[", "t", "]"}]}], "]"}], "+", 
       RowBox[{"Cross", "[", 
        RowBox[{
         RowBox[{"Q2", "[", "t", "]"}], ",", 
         RowBox[{
          RowBox[{"P2", "'"}], "[", "t", "]"}]}], "]"}], "+", 
       RowBox[{"Cross", "[", 
        RowBox[{
         RowBox[{"Q3", "[", "t", "]"}], ",", 
         RowBox[{
          RowBox[{"P3", "'"}], "[", "t", "]"}]}], "]"}], "+", 
       RowBox[{"Cross", "[", 
        RowBox[{
         RowBox[{"Q4", "[", "t", "]"}], ",", 
         RowBox[{
          RowBox[{"P4", "'"}], "[", "t", "]"}]}], "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"plot3", " ", "=", " ", 
     RowBox[{"InvariantErrorPlot", "[", 
      RowBox[{"angmom", ",", 
       RowBox[{"Join", "[", 
        RowBox[{"pos", ",", "mom"}], "]"}], ",", "t", ",", "sol", ",", 
       RowBox[{"PlotStyle", "\[Rule]", "Blue"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Show", " ", "conserved", " ", "quantities"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"GraphicsRow", "[", 
    RowBox[{"{", 
     RowBox[{"plot1", ",", "plot2", ",", "plot3"}], "}"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.8054373407957077`*^9, 3.8054374661614704`*^9}, {
  3.8054376458479905`*^9, 3.8054376755327735`*^9}, {3.8057217099940023`*^9, 
  3.8057217660598927`*^9}},
 CellLabel->
  "In[146]:=",ExpressionUUID->"465fd451-c196-4ae1-9494-e41c0b435c08"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"3", "D", " ", "Simulation"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"min1", "=", 
     RowBox[{
      RowBox[{"NMinimize", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Min", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Q1", "[", "t", "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
            RowBox[{
             RowBox[{"Q2", "[", "t", "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{
             RowBox[{"Q3", "[", "t", "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}], " ", ",", 
            RowBox[{
             RowBox[{"Q4", "[", "t", "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", " ", 
          RowBox[{"t", "\[GreaterEqual]", "0"}], ",", " ", 
          RowBox[{"t", "\[LessEqual]", "tmax"}]}], "}"}], ",", "t"}], "]"}], 
      "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"max1", "=", 
     RowBox[{
      RowBox[{"NMaximize", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Max", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Q1", "[", "t", "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
            RowBox[{
             RowBox[{"Q2", "[", "t", "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{
             RowBox[{"Q3", "[", "t", "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}], " ", ",", 
            RowBox[{
             RowBox[{"Q4", "[", "t", "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", " ", 
          RowBox[{"t", "\[GreaterEqual]", "0"}], ",", " ", 
          RowBox[{"t", "\[LessEqual]", "tmax"}]}], "}"}], ",", "t"}], "]"}], 
      "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"min2", "=", 
     RowBox[{
      RowBox[{"NMinimize", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Min", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Q1", "[", "t", "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}], ",", " ", 
            RowBox[{
             RowBox[{"Q2", "[", "t", "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}], ",", 
            RowBox[{
             RowBox[{"Q3", "[", "t", "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}], " ", ",", 
            RowBox[{
             RowBox[{"Q4", "[", "t", "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ",", " ", 
          RowBox[{"t", "\[GreaterEqual]", "0"}], ",", " ", 
          RowBox[{"t", "\[LessEqual]", "tmax"}]}], "}"}], ",", "t"}], "]"}], 
      "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"max2", "=", 
     RowBox[{
      RowBox[{"NMaximize", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Max", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Q1", "[", "t", "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}], ",", " ", 
            RowBox[{
             RowBox[{"Q2", "[", "t", "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}], ",", 
            RowBox[{
             RowBox[{"Q3", "[", "t", "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}], " ", ",", 
            RowBox[{
             RowBox[{"Q4", "[", "t", "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ",", " ", 
          RowBox[{"t", "\[GreaterEqual]", "0"}], ",", " ", 
          RowBox[{"t", "\[LessEqual]", "tmax"}]}], "}"}], ",", "t"}], "]"}], 
      "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"min3", "=", 
     RowBox[{
      RowBox[{"NMinimize", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Min", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Q1", "[", "t", "]"}], "[", 
             RowBox[{"[", "3", "]"}], "]"}], ",", " ", 
            RowBox[{
             RowBox[{"Q2", "[", "t", "]"}], "[", 
             RowBox[{"[", "3", "]"}], "]"}], ",", 
            RowBox[{
             RowBox[{"Q3", "[", "t", "]"}], "[", 
             RowBox[{"[", "3", "]"}], "]"}], " ", ",", 
            RowBox[{
             RowBox[{"Q4", "[", "t", "]"}], "[", 
             RowBox[{"[", "3", "]"}], "]"}]}], "]"}], ",", " ", 
          RowBox[{"t", "\[GreaterEqual]", "0"}], ",", " ", 
          RowBox[{"t", "\[LessEqual]", "tmax"}]}], "}"}], ",", "t"}], "]"}], 
      "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"max3", "=", 
     RowBox[{
      RowBox[{"NMaximize", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Max", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Q1", "[", "t", "]"}], "[", 
             RowBox[{"[", "3", "]"}], "]"}], ",", " ", 
            RowBox[{
             RowBox[{"Q2", "[", "t", "]"}], "[", 
             RowBox[{"[", "3", "]"}], "]"}], ",", 
            RowBox[{
             RowBox[{"Q3", "[", "t", "]"}], "[", 
             RowBox[{"[", "3", "]"}], "]"}], " ", ",", 
            RowBox[{
             RowBox[{"Q4", "[", "t", "]"}], "[", 
             RowBox[{"[", "3", "]"}], "]"}]}], "]"}], ",", " ", 
          RowBox[{"t", "\[GreaterEqual]", "0"}], ",", " ", 
          RowBox[{"t", "\[LessEqual]", "tmax"}]}], "}"}], ",", "t"}], "]"}], 
      "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"m", " ", "=", " ", 
    RowBox[{"Animate", "[", 
     RowBox[{
      RowBox[{"Show", "[", 
       RowBox[{
        RowBox[{"Graphics3D", "[", 
         RowBox[{"{", 
          RowBox[{"Red", ",", 
           RowBox[{"Sphere", "[", 
            RowBox[{
             RowBox[{"Q1", "[", "t", "]"}], ",", ".1"}], "]"}]}], "}"}], 
         "]"}], ",", 
        RowBox[{"Graphics3D", "[", 
         RowBox[{"{", 
          RowBox[{"Red", ",", 
           RowBox[{"Sphere", "[", 
            RowBox[{
             RowBox[{"Q2", "[", "t", "]"}], ",", ".1"}], "]"}]}], "}"}], 
         "]"}], ",", 
        RowBox[{"Graphics3D", "[", 
         RowBox[{"{", 
          RowBox[{"Red", ",", 
           RowBox[{"Sphere", "[", 
            RowBox[{
             RowBox[{"Q3", "[", "t", "]"}], ",", ".1"}], "]"}]}], "}"}], 
         "]"}], ",", 
        RowBox[{"Graphics3D", "[", 
         RowBox[{"{", 
          RowBox[{"Red", ",", 
           RowBox[{"Sphere", "[", 
            RowBox[{
             RowBox[{"Q4", "[", "t", "]"}], ",", ".1"}], "]"}]}], "}"}], 
         "]"}], ",", 
        RowBox[{"Graphics3D", "[", 
         RowBox[{"{", 
          RowBox[{"Black", ",", 
           RowBox[{"Line", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Q1", "[", "t", "]"}], ",", 
              RowBox[{"Q2", "[", "t", "]"}]}], "}"}], "]"}]}], "}"}], "]"}], 
        ",", 
        RowBox[{"Graphics3D", "[", 
         RowBox[{"{", 
          RowBox[{"Black", ",", 
           RowBox[{"Line", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Q2", "[", "t", "]"}], ",", 
              RowBox[{"Q3", "[", "t", "]"}]}], "}"}], "]"}]}], "}"}], "]"}], 
        " ", ",", 
        RowBox[{"Graphics3D", "[", 
         RowBox[{"{", 
          RowBox[{"Black", ",", 
           RowBox[{"Line", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Q3", "[", "t", "]"}], ",", 
              RowBox[{"Q4", "[", "t", "]"}]}], "}"}], "]"}]}], "}"}], "]"}], 
        " ", ",", 
        RowBox[{"PlotRange", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"min1", "-", "0.1"}], ",", " ", 
             RowBox[{"max1", "+", "0.1"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"min2", "-", "0.1"}], ",", " ", 
             RowBox[{"max2", "+", "0.1"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"min3", "-", "0.1"}], ",", " ", 
             RowBox[{"max3", "+", "0.1"}]}], "}"}]}], "}"}]}], ",", 
        RowBox[{"Axes", "\[Rule]", "False"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"t", ",", "0", ",", "tmax"}], "}"}], ",", " ", 
      RowBox[{"AnimationRunning", "\[Rule]", "False"}], ",", " ", 
      RowBox[{"AnimationRate", "\[Rule]", "0.75"}]}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Export", "[", 
     RowBox[{"\"\<MyAutorun.mp4\>\"", ",", "m"}], "]"}], "*)"}]}]}]], "Input",
 CellChangeTimes->{{3.8052926481013327`*^9, 3.805292665406001*^9}, {
   3.8052966169897413`*^9, 3.8052966179401045`*^9}, {3.805297055497005*^9, 
   3.805297059297905*^9}, 3.8054379795787716`*^9, {3.8055577806376*^9, 
   3.805557783915946*^9}, {3.8056540057485604`*^9, 3.8056540213071413`*^9}, {
   3.805721832870098*^9, 3.805721833364622*^9}, {3.8069159110608635`*^9, 
   3.806915914232342*^9}, {3.832575255629217*^9, 3.8325752584260063`*^9}, {
   3.832584995955626*^9, 3.832585001574976*^9}, {3.8325854643730226`*^9, 
   3.832585464741364*^9}, {3.8334607563807983`*^9, 3.8334607587864747`*^9}, 
   3.8513397672160654`*^9, {3.851341421247037*^9, 3.8513414247356462`*^9}, {
   3.90440444231322*^9, 
   3.904404450184781*^9}},ExpressionUUID->"84a7833c-f92d-4231-8911-\
4e03dbd045fe"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Check", " ", "bond"}], "-", "length"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"meanq1q2", " ", "=", " ", 
     RowBox[{"Mean", "[", 
      RowBox[{
       RowBox[{"Norm", "[", 
        RowBox[{
         RowBox[{"Q1", "[", "t", "]"}], "-", 
         RowBox[{"Q2", "[", "t", "]"}]}], "]"}], "/.", 
       RowBox[{"t", "\[Rule]", "points"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"plot1", " ", "=", " ", 
     RowBox[{"Plot", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"Norm", "[", 
           RowBox[{
            RowBox[{"Q1", "[", "t", "]"}], "-", 
            RowBox[{"Q2", "[", "t", "]"}]}], "]"}], "/.", 
          RowBox[{"t", "\[Rule]", "points"}]}], ",", " ", "meanq1q2"}], " ", 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"t", ",", "0", ",", "tmax"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"meanq2q3", " ", "=", " ", 
     RowBox[{"Mean", "[", 
      RowBox[{
       RowBox[{"Norm", "[", 
        RowBox[{
         RowBox[{"Q2", "[", "t", "]"}], "-", 
         RowBox[{"Q3", "[", "t", "]"}]}], "]"}], "/.", 
       RowBox[{"t", "\[Rule]", "points"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"plot2", " ", "=", " ", 
     RowBox[{"Plot", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"Norm", "[", 
           RowBox[{
            RowBox[{"Q2", "[", "t", "]"}], "-", 
            RowBox[{"Q3", "[", "t", "]"}]}], "]"}], "/.", 
          RowBox[{"t", "\[Rule]", "points"}]}], ",", " ", "meanq2q3"}], " ", 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"t", ",", "0", ",", "tmax"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"meanq3q4", " ", "=", " ", 
     RowBox[{"Mean", "[", 
      RowBox[{
       RowBox[{"Norm", "[", 
        RowBox[{
         RowBox[{"Q3", "[", "t", "]"}], "-", 
         RowBox[{"Q4", "[", "t", "]"}]}], "]"}], "/.", 
       RowBox[{"t", "\[Rule]", "points"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"plot3", " ", "=", " ", 
     RowBox[{"Plot", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"Norm", "[", 
           RowBox[{
            RowBox[{"Q3", "[", "t", "]"}], "-", 
            RowBox[{"Q4", "[", "t", "]"}]}], "]"}], "/.", 
          RowBox[{"t", "\[Rule]", "points"}]}], ",", " ", "meanq3q4"}], " ", 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"t", ",", "0", ",", "tmax"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"GraphicsRow", "[", 
    RowBox[{"{", 
     RowBox[{"plot1", ",", "plot2", ",", "plot3"}], "}"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.8015075817332144`*^9, 3.8015075966530876`*^9}, 
   3.801507791341764*^9, {3.801550975328541*^9, 3.8015509767157173`*^9}, 
   3.801552179788526*^9, {3.8016633152453694`*^9, 3.8016633257157054`*^9}, {
   3.801664357751071*^9, 3.801664358215559*^9}, {3.801664691397987*^9, 
   3.801664700205411*^9}, {3.805101648043521*^9, 3.8051017203102903`*^9}, {
   3.8051018845454082`*^9, 3.8051019998117046`*^9}, {3.805102112681471*^9, 
   3.805102171716441*^9}, {3.805102267859759*^9, 3.805102285857258*^9}, {
   3.805291439509039*^9, 3.805291501230881*^9}, {3.805438342243228*^9, 
   3.8054383424996853`*^9}, {3.805446823725771*^9, 3.8054468242934957`*^9}, {
   3.8057220055165634`*^9, 3.8057220213192225`*^9}, {3.8325754624447107`*^9, 
   3.8325754650863304`*^9}, {3.904401154170072*^9, 3.904401160146986*^9}},
 CellLabel->
  "In[158]:=",ExpressionUUID->"4acf079e-e2b6-4292-ae46-19352cb72da8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Check", " ", "bond"}], "-", "angle"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"mean1", " ", "=", " ", 
     RowBox[{
      RowBox[{"Mean", "[", 
       RowBox[{
        RowBox[{"VectorAngle", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Q1", "[", "t", "]"}], "-", 
           RowBox[{"Q2", "[", "t", "]"}]}], ",", 
          RowBox[{
           RowBox[{"Q3", "[", "t", "]"}], "-", 
           RowBox[{"Q2", "[", "t", "]"}]}]}], "]"}], "/.", 
        RowBox[{"t", "\[Rule]", "points"}]}], "]"}], "*", 
      RowBox[{"180", "/", "\[Pi]"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"plot1", " ", "=", " ", 
     RowBox[{"Plot", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"VectorAngle", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Q1", "[", "t", "]"}], "-", 
             RowBox[{"Q2", "[", "t", "]"}]}], ",", 
            RowBox[{
             RowBox[{"Q3", "[", "t", "]"}], "-", 
             RowBox[{"Q2", "[", "t", "]"}]}]}], "]"}], "*", 
          RowBox[{"180", "/", "\[Pi]"}]}], ",", "mean1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"t", ",", "0", ",", "tmax"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"mean2", " ", "=", 
     RowBox[{
      RowBox[{"Mean", "[", 
       RowBox[{
        RowBox[{"VectorAngle", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Q2", "[", "t", "]"}], "-", 
           RowBox[{"Q3", "[", "t", "]"}]}], ",", 
          RowBox[{
           RowBox[{"Q4", "[", "t", "]"}], "-", 
           RowBox[{"Q3", "[", "t", "]"}]}]}], "]"}], "/.", 
        RowBox[{"t", "\[Rule]", "points"}]}], "]"}], "*", 
      RowBox[{"180", "/", "\[Pi]"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"plot2", " ", "=", " ", 
     RowBox[{"Plot", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"VectorAngle", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Q2", "[", "t", "]"}], "-", 
             RowBox[{"Q3", "[", "t", "]"}]}], ",", 
            RowBox[{
             RowBox[{"Q4", "[", "t", "]"}], "-", 
             RowBox[{"Q3", "[", "t", "]"}]}]}], "]"}], "*", 
          RowBox[{"180", "/", "\[Pi]"}]}], ",", "mean2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"t", ",", "0", ",", "tmax"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"GraphicsRow", "[", 
    RowBox[{"{", 
     RowBox[{"plot1", ",", " ", "plot2"}], "}"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.8015075817332144`*^9, 3.8015075966530876`*^9}, 
   3.801507791341764*^9, {3.801550975328541*^9, 3.8015509767157173`*^9}, 
   3.801552179788526*^9, {3.8016633152453694`*^9, 3.8016633257157054`*^9}, {
   3.801664357751071*^9, 3.801664358215559*^9}, {3.801664691397987*^9, 
   3.801664700205411*^9}, {3.805101648043521*^9, 3.8051017203102903`*^9}, {
   3.8051018845454082`*^9, 3.8051019998117046`*^9}, {3.805102112681471*^9, 
   3.805102171716441*^9}, {3.805102267859759*^9, 3.805102445243866*^9}, {
   3.805102496153413*^9, 3.8051025355023255`*^9}, {3.8051026730013723`*^9, 
   3.8051027076429944`*^9}, {3.8054468186837015`*^9, 3.805446819284422*^9}, {
   3.805722024799575*^9, 3.8057220345181427`*^9}, {3.8325754680856733`*^9, 
   3.832575471547639*^9}, {3.9044011737502737`*^9, 3.904401176057289*^9}},
 CellLabel->
  "In[165]:=",ExpressionUUID->"09645194-83b7-4588-9401-059ef730deeb"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Molecule", " ", "length"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"MolLen", "=", 
   RowBox[{"Plot", "[", 
    RowBox[{
     RowBox[{"Norm", "[", 
      RowBox[{
       RowBox[{"Q1", "[", "t", "]"}], "-", 
       RowBox[{"Q4", "[", "t", "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"t", ",", "0", ",", "tmax"}], "}"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.80166473664176*^9, 3.8016647535195932`*^9}, {
  3.805103005407933*^9, 3.8051030441003714`*^9}, {3.805655242688467*^9, 
  3.805655247797347*^9}, {3.8057220558784113`*^9, 3.805722057808957*^9}, {
  3.806834913625021*^9, 3.8068349146746864`*^9}, {3.806863131301612*^9, 
  3.8068631477859154`*^9}, {3.8068660293908167`*^9, 3.806866029517373*^9}, {
  3.832575474631228*^9, 3.8325754774389925`*^9}, {3.904401229054813*^9, 
  3.904401233461227*^9}},
 CellLabel->
  "In[170]:=",ExpressionUUID->"48d996ba-c9dc-46aa-af92-6241488f9174"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Torsion", " ", "angle", " ", "function"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"\[Psi]", "[", "t_", "]"}], ":=", 
    RowBox[{"VectorAngle", "[", 
     RowBox[{
      RowBox[{"Cross", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Q2", "[", "t", "]"}], "-", 
         RowBox[{"Q1", "[", "t", "]"}]}], ",", " ", 
        RowBox[{
         RowBox[{"Q3", "[", "t", "]"}], "-", 
         RowBox[{"Q2", "[", "t", "]"}]}]}], "]"}], ",", 
      RowBox[{"Cross", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Q3", "[", "t", "]"}], "-", 
         RowBox[{"Q2", "[", "t", "]"}]}], ",", 
        RowBox[{
         RowBox[{"Q4", "[", "t", "]"}], "-", 
         RowBox[{"Q3", "[", "t", "]"}]}]}], "]"}]}], "]"}]}], 
   ";"}]}]], "Input",
 CellChangeTimes->{{3.807850353441033*^9, 3.807850360530491*^9}, {
  3.808238126337676*^9, 3.808238129370075*^9}, {3.832575480852543*^9, 
  3.8325754833680673`*^9}, {3.9044012575416737`*^9, 3.9044012623540287`*^9}},
 CellLabel->
  "In[171]:=",ExpressionUUID->"3e8dbe73-b9c4-44f1-bc40-d016d8ffc209"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Check", " ", "tornsion"}], "-", "angle"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"TorAngle", "=", 
   RowBox[{"Plot", "[", 
    RowBox[{
     RowBox[{"\[Psi]", "[", "t", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"t", ",", "0", ",", "tmax"}], "}"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.8055408547208786`*^9, 3.8055409448941073`*^9}, {
  3.8055409803602543`*^9, 3.805541034637209*^9}, {3.805541213988347*^9, 
  3.8055412170395594`*^9}, {3.8057220483008337`*^9, 3.8057220640659246`*^9}, {
  3.8068349194460373`*^9, 3.8068349195220947`*^9}, {3.8068631508876266`*^9, 
  3.806863154373031*^9}, {3.8068660337866106`*^9, 3.806866033946517*^9}, {
  3.807850369522358*^9, 3.80785037231756*^9}, {3.8082394712575197`*^9, 
  3.8082394722094593`*^9}, {3.832575485893257*^9, 3.832575490294056*^9}, {
  3.9044012668407373`*^9, 3.904401271086581*^9}},
 CellLabel->
  "In[172]:=",ExpressionUUID->"966e37df-c5df-4fdf-8882-5c30af3a33fa"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Energy", " ", "parametric", " ", "plot"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"plot1", "=", 
     RowBox[{"Plot", "[", 
      RowBox[{
       RowBox[{"Vweakt", "[", "\[Theta]", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Theta]", ",", "0", ",", 
         RowBox[{"2", "\[Pi]"}]}], "}"}]}], "]"}]}], ";"}], "\n", 
   RowBox[{"Animate", "[", 
    RowBox[{
     RowBox[{"Show", "[", 
      RowBox[{"plot1", ",", 
       RowBox[{"Graphics", "[", 
        RowBox[{"{", 
         RowBox[{"Red", ",", 
          RowBox[{"Disk", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"\[Psi]", "[", "t", "]"}], ",", 
              RowBox[{"Vweakt", "[", 
               RowBox[{"\[Psi]", "[", "t", "]"}], "]"}]}], "}"}], ",", ".1"}],
            "]"}]}], "}"}], "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"t", ",", "0", ",", "tmax"}], "}"}], ",", " ", 
     RowBox[{"AnimationRate", "\[Rule]", "0.75"}], ",", 
     RowBox[{"AnimationRunning", "\[Rule]", "False"}]}], " ", 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.80554414957272*^9, 3.805544170757155*^9}, {
  3.805544301238225*^9, 3.8055443158818674`*^9}, {3.805544353038859*^9, 
  3.805544409916689*^9}, {3.80554452734251*^9, 3.8055445283664465`*^9}, {
  3.8055446526464005`*^9, 3.8055446720916452`*^9}, {3.805544705841381*^9, 
  3.8055447066422462`*^9}, {3.805557701424965*^9, 3.8055577249449406`*^9}, {
  3.8057220706565914`*^9, 3.805722096169283*^9}, {3.8078503496689415`*^9, 
  3.807850350282358*^9}, {3.808239476819912*^9, 3.8082394841349154`*^9}, {
  3.8325754935589156`*^9, 3.8325754975399666`*^9}, {3.904401283845367*^9, 
  3.904401285977944*^9}},
 CellLabel->
  "In[173]:=",ExpressionUUID->"99e79c3e-c55c-4ab1-a748-40f9c4211de4"]
},
WindowSize->{1440., 771.75},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"13.2 for Linux x86 (64-bit) (December 7, 2022)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"03deae06-a65d-4936-93f8-57288b9e1862"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 3814, 72, 260, "Input",ExpressionUUID->"51004c14-f735-4926-bb05-59b7327f100a"],
Cell[4375, 94, 3447, 73, 156, "Input",ExpressionUUID->"ba5c78f6-549a-4c2b-94b2-e0096d9c9098"],
Cell[7825, 169, 2207, 33, 32, "Input",ExpressionUUID->"2c4e49c0-b907-45fc-aea6-23b66535ea9c"],
Cell[10035, 204, 4713, 105, 190, "Input",ExpressionUUID->"0a03b019-faf3-48b0-af6c-1ca2cf1bbbb9"],
Cell[14751, 311, 2439, 35, 33, "Input",ExpressionUUID->"d869491e-a87f-4745-b2d3-6a98953c6a24"],
Cell[17193, 348, 2517, 37, 33, "Input",ExpressionUUID->"9cd61fd8-55f1-4717-bb49-553672127a93"],
Cell[19713, 387, 8081, 220, 450, "Input",ExpressionUUID->"aea67561-4661-4c1d-b100-f1a94fb3102a"],
Cell[27797, 609, 5669, 160, 392, "Input",ExpressionUUID->"4a0e5709-a5b2-4adf-957b-a817991c7201"],
Cell[33469, 771, 5434, 122, 156, "Input",ExpressionUUID->"2d00c411-dc66-444f-808b-68d685681a19"],
Cell[38906, 895, 5734, 154, 555, "Input",ExpressionUUID->"4073beca-0768-45da-92ad-386bf331ba59"],
Cell[44643, 1051, 4324, 122, 525, "Input",ExpressionUUID->"0009769c-c768-432c-a5ef-f73214e7ffab"],
Cell[48970, 1175, 8257, 196, 291, "Input",ExpressionUUID->"01c6c25d-d491-4869-a683-b2fd98e4455b"],
Cell[57230, 1373, 7165, 206, 456, "Input",ExpressionUUID->"89ceac61-97e4-4cd8-8d1b-74c7d8be786e"],
Cell[64398, 1581, 3503, 57, 75, "Input",ExpressionUUID->"06c97fb3-91b3-4725-b75e-77fb30a82e1a"],
Cell[67904, 1640, 3684, 59, 44, "Input",ExpressionUUID->"a1c691ce-10bd-43d3-8a72-f9ec3c589df9"],
Cell[71591, 1701, 254, 5, 32, "Input",ExpressionUUID->"f87d4c61-799e-4958-9220-c01af9ac4888"],
Cell[71848, 1708, 5469, 83, 32, "Input",ExpressionUUID->"9248b7f6-8275-41a2-b663-b24c111efc62"],
Cell[77320, 1793, 3350, 52, 44, "Input",ExpressionUUID->"dfc9d0db-6d7d-4173-ad5f-99694d848453"],
Cell[80673, 1847, 3352, 52, 44, "Input",ExpressionUUID->"77ec5743-383c-4734-b82c-5b2a88ad73dd"],
Cell[84028, 1901, 3352, 52, 44, "Input",ExpressionUUID->"6da000da-e3af-45ea-965a-e7767e434474"],
Cell[87383, 1955, 3350, 52, 44, "Input",ExpressionUUID->"d798ae0e-75d6-4306-82d6-fcc41427a797"],
Cell[90736, 2009, 3378, 53, 44, "Input",ExpressionUUID->"cc43dc14-9a1d-44e6-8f43-058930500451"],
Cell[94117, 2064, 312, 8, 29, "Input",ExpressionUUID->"06adbcb6-773a-4081-8410-cda966de50c4"],
Cell[94432, 2074, 3985, 94, 144, "Input",ExpressionUUID->"f6ab9d09-df3b-4753-9e07-5360b3849896"],
Cell[98420, 2170, 10301, 224, 486, "Input",ExpressionUUID->"18dfc54f-293f-4642-9db9-5f36a65c5253"],
Cell[108724, 2396, 1959, 54, 218, "Input",ExpressionUUID->"163077aa-f37a-4873-bfec-27962e210256"],
Cell[110686, 2452, 2674, 74, 180, "Input",ExpressionUUID->"465fd451-c196-4ae1-9494-e41c0b435c08"],
Cell[113363, 2528, 9497, 250, 257, "Input",ExpressionUUID->"84a7833c-f92d-4231-8911-4e03dbd045fe"],
Cell[122863, 2780, 3757, 100, 185, "Input",ExpressionUUID->"4acf079e-e2b6-4292-ae46-19352cb72da8"],
Cell[126623, 2882, 3553, 90, 139, "Input",ExpressionUUID->"09645194-83b7-4588-9401-059ef730deeb"],
Cell[130179, 2974, 956, 21, 52, "Input",ExpressionUUID->"48d996ba-c9dc-46aa-af92-6241488f9174"],
Cell[131138, 2997, 1131, 31, 54, "Input",ExpressionUUID->"3e8dbe73-b9c4-44f1-bc40-d016d8ffc209"],
Cell[132272, 3030, 1003, 21, 52, "Input",ExpressionUUID->"966e37df-c5df-4fdf-8882-5c30af3a33fa"],
Cell[133278, 3053, 1838, 44, 77, "Input",ExpressionUUID->"99e79c3e-c55c-4ab1-a748-40f9c4211de4"]
}
]
*)

